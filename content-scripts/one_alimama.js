var onealimama=function(){"use strict";var Oe=Object.defineProperty;var Fe=(q,M,S)=>M in q?Oe(q,M,{enumerable:!0,configurable:!0,writable:!0,value:S}):q[M]=S;var l=(q,M,S)=>Fe(q,typeof M!="symbol"?M+"":M,S);var Ot,Ft;function q(e){return e}const S=(Ft=(Ot=globalThis.browser)==null?void 0:Ot.runtime)!=null&&Ft.id?globalThis.browser:globalThis.chrome,V={"sycm.taobao":{name:"生意参谋",domain:"sycm.taobao",fullDomain:"sycm.taobao.com"},"one.alimama":{name:"阿里妈妈万象台",domain:"one.alimama",fullDomain:"one.alimama.com"},taobao:{name:"淘宝",domain:"taobao",fullDomain:"taobao.com"},tmall:{name:"天猫",domain:"tmall",fullDomain:"tmall.com"},tmallhk:{name:"天猫国际",domain:"tmallhk",fullDomain:"tmall.hk"},douyin:{name:"抖音",domain:"douyin",fullDomain:"douyin.com"},xiaohongshu:{name:"小红书",domain:"xiaohongshu",fullDomain:"xiaohongshu.com"},jd:{name:"京东",domain:"jd",fullDomain:"jd.com"},tiktok:{name:"tiktok",domain:"tiktok",fullDomain:"tiktok.com"},youtube:{name:"youtube",domain:"youtube",fullDomain:"youtube.com"},other:{name:"其他",domain:"other",fullDomain:"other"}};function Vt(e){console.log("getDomain",e),e||(e=window.location.href);for(let t in V)if(e.includes(V[t].fullDomain))return V[t].domain;return V.other.domain}function Bt(e,t="data_"){return e&&e.indexOf("https://sycm.taobao.com/cc/customer/trip")===0?e="https://sycm.taobao.com/cc/customer/trip":e&&e.indexOf("https://sycm.taobao.com/cc/customer/overview")===0?e="https://sycm.taobao.com/cc/customer/overview":e&&e.indexOf("https://one.alimama.com/index.html#!/manage/onesite")===0&&(e="https://one.alimama.com/index.html#!/manage/onesite"),t+btoa(e)}function Tt(){return new Promise(e=>{const t=document.body.scrollHeight,o=t/10;let a=0;const n=setInterval(()=>{a<t?(window.scrollTo(0,a),a+=o):(window.scrollTo(0,0),clearInterval(n),e(!0))},200)})}function C(e,t=5e3){return new Promise((o,a)=>{console.log(`等待元素加载: ${e}, 超时: ${t}ms`);const n=document.querySelector(e);if(n)return o(n);const i=setTimeout(()=>{if(s){s.disconnect(),console.log(`等待元素超时: ${e}`);const r=document.querySelector(e);r?o(r):a(new Error(`等待元素超时: ${e}`))}},t),s=new MutationObserver((r,u)=>{const d=document.querySelector(e);d&&(clearTimeout(i),u.disconnect(),o(d))});s.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","data-e2e"]}),console.log("MutationObserver已启动")})}class $t{constructor(){l(this,"sleep",t=>new Promise(o=>setTimeout(o,t)));l(this,"runDelay",async(t,o)=>new Promise(a=>setTimeout(()=>{a(t())},o)));l(this,"sendMessage",t=>{S.runtime.sendMessage({action:"updateStatus",status:t})});l(this,"sendDataWithAction",(t,o)=>{S.runtime.sendMessage({action:o,data:t})});l(this,"openPopup",(t=-1)=>{S.runtime.sendMessage({action:"openPopup",windowId:t})});l(this,"openSidePanel",(t=-1)=>{S.runtime.sendMessage({action:"openSidePanel",windowId:t})});l(this,"elementHover",(t,o=!0)=>{t.dispatchEvent(new MouseEvent(o?"mouseover":"mouseout",{bubbles:!0}))});l(this,"setElementAnimation",t=>{const o="266A247A-6C68-4F89-8D11-B767B4E7A71C",a="animation_"+o.slice(0,8),n="class_"+o.slice(0,8);if(!document.head.querySelector(`style[data-id='${o}']`)){const i=document.createElement("style");i.type="text/css",i.setAttribute("data-id",o);const s=`
      @keyframes ${a}{
        to {  background-color :rgb(255, 0, 0);
              border: 1px solid blue;
              border-radius: 3px;
        }
      }
    `,r=`
      .${n} {
        animation: ${a} 0.5s ease-in-out 0s 2 alternate none;
      }
    `;i.innerHTML=s+r,document.head.appendChild(i)}return t.classList.remove(n),t.offsetHeight,t.classList.add(n),t});l(this,"waitForChildListChange",async(t,o,a=5e3)=>new Promise((n,i)=>{const s=setTimeout(()=>{r&&(r.disconnect(),console.log("等待元素更新超时: ",o,`超时时间：${a}ms`),n(!1))},a),r=new MutationObserver((u,d)=>{if(u.length>0)for(const h of u)if(h.type==="attributes")h.attributeName;else if(h.type==="childList"){clearTimeout(s),d.disconnect(),n(!0);return}else h.type});r.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0}),t&&t()}));l(this,"waitForElementTextChange",async(t,o,a=5e3)=>new Promise((n,i)=>{console.log("等待元素更新:",o,` 超时: ${a}ms`);const s=setTimeout(()=>{r&&(r.disconnect(),console.log("等待元素更新超时: ",o,`超时时间：${a}ms`),n(!1))},a),r=new MutationObserver((u,d)=>{if(u.length>0){for(const h of u)if(h.type==="attributes")h.attributeName;else if(h.type!=="childList"){if(h.type==="characterData"){clearTimeout(s),d.disconnect(),n(!0);return}}}});r.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0}),t&&t()}));l(this,"waitForElementAttrChange",async(t,o,a=5e3)=>new Promise((n,i)=>{console.log("等待元素属性更新:",o,` 超时: ${a}ms`);const s=setTimeout(()=>{r&&(r.disconnect(),console.log("等待元素属性更新超时: ",o,`超时时间：${a}ms`),n(!1))},a),r=new MutationObserver((u,d)=>{if(u.length>0)for(const h of u)if(h.type==="attributes"){h.attributeName,clearTimeout(s),d.disconnect(),n(!0);return}else h.type==="childList"||h.type});r.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0}),t&&t()}));l(this,"waitForElementListTextChange",async(t,o,a=5e3,n=!0)=>{let i=[];return new Promise((s,r)=>{o.forEach(u=>{this.waitForElementTextChange(()=>{},u,a).then(async d=>{i.push({target:u,result:d}),n?i.length===o.length&&s(i):i.length==1&&(await this.sleep(500),s(i))})}),t&&t()})});l(this,"waitForElementListAttrChange",async(t,o,a=5e3,n=!0)=>{let i=[];return new Promise((s,r)=>{o.forEach(u=>{this.waitForElementAttrChange(()=>{},u,a).then(async d=>{i.push({target:u,result:d}),n?i.length===o.length&&s(i):i.length==1&&(await this.sleep(500),s(i))})}),t&&t()})});l(this,"waitForElementRemove",async(t,o=5e3)=>new Promise((a,n)=>{const s=o/10;let r=0;const u=setInterval(()=>{if(!document.querySelector(t)){clearInterval(u),a(!0);return}r++,r<s?console.log("等待元素移除:",t,` 超时: ${o}ms`,`剩余时间：${o-r*10}ms`):(console.log("等待元素移除超时: ",t,`超时时间：${o}ms`),clearInterval(u),n(!1))},10)}));l(this,"scrollToElementTop",t=>{t.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})});l(this,"scrollToElement",t=>{t.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})});l(this,"scrollToElementBottom",t=>{t.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})});l(this,"ensureElementVisible",t=>{let o=t;for(;o&&o!==document.body;){const r=o.parentElement;if(!r)break;const u=r.scrollHeight>r.clientHeight,d=r.scrollWidth>r.clientWidth;if(u||d){const h=r.getBoundingClientRect(),g=o.getBoundingClientRect();u&&(g.top<h.top?r.scrollTop-=h.top-g.top:g.bottom>h.bottom&&(r.scrollTop+=g.bottom-h.bottom)),d&&(g.left<h.left?r.scrollLeft-=h.left-g.left:g.right>h.right&&(r.scrollLeft+=g.right-h.right))}o=r}const a=window.scrollY,n=a+window.innerHeight,i=t.offsetTop,s=i+t.offsetHeight;i<a?window.scrollTo({top:i,behavior:"smooth"}):s>n&&window.scrollTo({top:s-window.innerHeight,behavior:"smooth"})});l(this,"getTextNodeValue",(t,o=!1)=>{this.setElementAnimation(t);const a=Array.from(t.childNodes).filter(n=>n.nodeType===Node.TEXT_NODE).map(n=>n.textContent).join("");return o?+a.replace(/[^\d-.]/g,""):a});l(this,"getElementText",(t,o=!0)=>t?(o&&this.setElementAnimation(t),t.textContent):"");l(this,"getElementTextToNumber",(t,o=!0)=>{if(t){const a=this.getElementText(t,o).replace(/[^\d-.]/g,"");return a&&!isNaN(a)?+a:a}return 0});l(this,"getUserInputNumber",async(t=10,o="请输入最大数据条数，默认10条，最小1条，最大100条",a=100)=>{let n=await this.showInput(o,t,a);for(;n;){let i=0;if(!isNaN(n)&&(i=parseInt(n),i>0&&i<=a)){t=i;break}n=await this.showInput(o,t,a)}return t});l(this,"waitElementInViewportUseObserver",async(t,o=5e3)=>new Promise((a,n)=>{this.isElementInViewport(t)&&a(!0),setTimeout(()=>{a(!1),i.disconnect()},o);const i=new IntersectionObserver(s=>{s.forEach(async r=>{r.isIntersecting&&(a(!0),i.disconnect())})});if(!t)return n("元素不存在");this.scrollToElement(t),i.observe(t)}));l(this,"waitElementInViewportUseClientRect",async(t,o=!1,a=5e3)=>{new Promise(async(n,i)=>{if(!t||typeof t.getBoundingClientRect!="function")return n(!1);let s=null;const r=()=>{const g=t.getBoundingClientRect(),b=window.innerHeight||document.documentElement.clientHeight,m=window.innerWidth||document.documentElement.clientWidth;let p=!1;if(o)p=g.top>=0&&g.bottom<=b&&g.left>=0&&g.right<=m;else{const P=g.top<=b&&g.bottom>=0,I=g.left<=m&&g.right>=0;p=P&&I}p&&(s&&clearInterval(s),n(!0))},u=10,d=parseInt(a/u+"")>0?parseInt(a/u+""):1;let h=0;s=setInterval(()=>{h++,h>d?(s&&clearInterval(s),n(!1)):r()},u)})});l(this,"isElementInViewport",t=>{const o=t.getBoundingClientRect(),a=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth;return o.top<a&&o.bottom>0&&o.left<n&&o.right>0});l(this,"getItemTextAndLog",(t,o,a,n="")=>{const i=this.querySelector(t,o);let s=this.getElementText(i);return n&&(s=(i==null?void 0:i.getAttribute(n))||""),a&&!i&&console.log(a),s});l(this,"waitForResult",async(t,o=5e3)=>{const a=Math.floor(o/100);for(let n=0;n<a;n++){if(await t())return!0;await this.sleep(100)}return!1});l(this,"getNumberText",t=>{const o=t.match(/[\.\d]+(千万)?(万亿)?[万|亿|k|K|m|M|b|B]?/);return o?o[0]:t})}deepScroll(t){return new Promise((o,a)=>{const n=[],i={element:t.element||window,duration:t.duration||500,easing:t.easing||"easeInOutQuad",scrollContainers:n,left:t.left,top:t.top,target:t.target,callback:t.callback};function s(c){const x=[];let w=c;for(;w&&w!==document.documentElement;)r(w)&&x.push(w),w=w.parentElement;return u()&&x.push(window),x}function r(c){if(c===window||!(c instanceof HTMLElement))return!0;const x=getComputedStyle(c),w=x.overflowY==="auto"||x.overflowY==="scroll",R=x.overflowX==="auto"||x.overflowX==="scroll";return w&&c.scrollHeight>c.clientHeight||R&&c.scrollWidth>c.clientWidth}function u(){return document.documentElement.scrollHeight>window.innerHeight}function d(c,x){const w=x.getBoundingClientRect();if(c instanceof Window)return{top:h(w.top-window.pageYOffset+window.outerHeight,w.height,window.innerHeight,window.outerHeight),left:h(w.left-window.pageXOffset+window.outerWidth,w.width,window.innerWidth,window.outerWidth)};const R=c.getBoundingClientRect();return{top:h(w.top-R.top+c.scrollTop,w.height,c.clientHeight,c.scrollTop),left:h(w.left-R.left+c.scrollLeft,w.width,c.clientWidth,c.scrollLeft)}}function h(c,x,w,R){const W=R,F=R+w,L=c+x;return c>=W&&L<=F?R:c<W?c:L-w}function g(c){return c instanceof Window?window.pageYOffset:c.scrollTop}function b(c){return c instanceof Window?window.pageXOffset:c.scrollLeft}function m(c,x,w){c instanceof Window?window.scrollTo(w,x):(c.scrollTop=x,c.scrollLeft=w)}if(i.target){const c=s(i.target);let x=i.target;c.forEach(w=>{const R=d(w,x);i.scrollContainers.push({element:w,startTop:g(w),targetTop:R.top,startLeft:b(w),targetLeft:R.left}),x=w})}else i.scrollContainers.push({element:i.element,startTop:g(i.element),targetTop:i.top??g(i.element),startLeft:b(i.element),targetLeft:i.left??b(i.element)});const p={linear:c=>c,easeInQuad:c=>c*c,easeOutQuad:c=>c*(2-c),easeInOutQuad:c=>c<.5?2*c*c:-1+(4-2*c)*c},P=p[i.easing]||p.easeInOutQuad;let I=0;const D=()=>{var c;o(""),i.target,(c=i.callback)==null||c.call(i)},T=c=>{I||(I=c);const x=c-I,w=Math.min(x/i.duration,1),R=P(w);i.scrollContainers.forEach(({element:W,startTop:F,targetTop:L,startLeft:qt,targetLeft:ke})=>{const Le=F+(L-F)*R,Ne=qt+(ke-qt)*R;m(W,Le,Ne)}),x<i.duration?requestAnimationFrame(T):D()};requestAnimationFrame(T)})}async showInput(t,o,a){return new Promise((n,i)=>{S.runtime.sendMessage({action:"showInput",placeholder:t,defaultValue:o,max:a},s=>{n(s.value)})})}simpleUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const o=Math.random()*16|0;return(t==="x"?o:o&3|8).toString(16)})}formatDateTime(t,o=!1){if(typeof t=="string")t=new Date(t);else if(typeof t=="number")t=new Date(t);else if(!(t instanceof Date))return"";if(isNaN(t))return"";const a={year:t.getFullYear(),mounth:t.getMonth()+1,day:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds(),ms:t.getMilliseconds()},n=(s,r=2)=>(s+"").padStart(r,"0");let i=`${a.year}-${n(a.mounth)}-${n(a.day)} ${n(a.hour)}:${n(a.minute)}:${n(a.second)}`;return o&&(i+=`:${a.ms}`),i}formatDate(t){const o=this.formatDateTime(t);return o?o.split(" ")[0]:""}parseChineseNumber(t){const o={万亿:1e12,千亿:1e11,百亿:1e10,十亿:1e9,亿:1e8,千万:1e7,百万:1e6,万:1e4,千:1e3,百:100,十:10,k:1e3,K:1e3,m:1e6,M:1e6,b:1e9,B:1e9,t:1e12,T:1e12};let a="";for(const d in o)a?a+="|"+d:a+=d;const n=String(t).match(new RegExp(`^(\\d+.?\\d*)([${a})]*)`));if(!n)return 0;const i=parseFloat(n[1]),s=n[2].trim(),r=Object.keys(o).find(d=>s.startsWith(d)),u=r?o[r]:1;return s==="千万"?i*1e7:i*u}querySelector(t,o=[]){let a=null;for(const n of o){const i=n.match(/(.+):contains\(['"](.+)['"]\)/);if(i){const s=i[1],r=i[2];if(a=t.querySelector(s),a&&a.textContent.includes(r))break}else if(a=t.querySelector(n),a)break}return a}querySelectorAll(t,o=[]){for(const a of o){const n=a.match(/(.+):contains\(['"](.+)['"]\)/);if(n){const i=n[1],s=n[2],r=t.querySelectorAll(i);if(r&&r.length>0)return Array.from(r).filter(d=>d.textContent.includes(s))}else{const i=t.querySelectorAll(a);if(i.length>0)return Array.from(i)}}return[]}querySelectorWithText(t,o=[],a=""){let n=null;for(const i of o)if(n=t.querySelectorAll(i),n.length>0){for(const s of n)if(s.textContent.includes(a))return s}return null}querySelectorAllWithText(t,o=[],a=""){let n=null;for(const i of o)if(n=t.querySelectorAll(i),n.length>0)return Array.from(n).filter(s=>s.textContent.includes(a));return[]}}const f=new $t;function Wt(e){S.runtime.onMessage.addListener((t,o,a)=>{if(t.action==="getData")return console.log("收到获取数据请求"),(async()=>{try{const n=await Ht(e);S.runtime.sendMessage({action:"dataReceived",data:n}),a({data:n})}catch(n){console.error("抓取数据时出错:",n),S.runtime.sendMessage({action:"dataError",error:n.message})}})(),a({action:"__default"}),!0})}async function Ht(e){const t=window.location.href,o=Bt(t),a=Vt(t);try{const n=await e(a,t);return console.log(`抓取到${a}数据:`,n),n.type=="unsupported"&&f.sendMessage("前页面不支持数据抓取"),await S.storage.local.set({[o]:{domain:a,type:n.type,data:n.data,timestamp:new Date().getTime(),fetchTime:n.fetchTime,url:t}}),n}catch(n){throw console.error("抓取过程中发生错误:",n),n}}/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Kt(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const jt=Object.assign,Ut=Object.prototype.hasOwnProperty,at=(e,t)=>Ut.call(e,t),B=Array.isArray,X=e=>St(e)==="[object Map]",Yt=e=>typeof e=="string",H=e=>typeof e=="symbol",z=e=>e!==null&&typeof e=="object",Gt=Object.prototype.toString,St=e=>Gt.call(e),Xt=e=>St(e).slice(8,-1),it=e=>Yt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Q=(e,t)=>!Object.is(e,t);/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let zt,Ct=0,rt;function st(){Ct++}function lt(){if(--Ct>0)return;let e;for(;rt;){let t=rt;for(rt=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(a){e||(e=a)}t=o}}if(e)throw e}let J=!0;const Dt=[];function Qt(){Dt.push(J),J=!1}function Jt(){const e=Dt.pop();J=e===void 0?!0:e}class Zt{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){}trigger(t){this.version++,this.notify(t)}notify(t){st();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{lt()}}}const ct=new WeakMap,N=Symbol(""),ut=Symbol(""),K=Symbol("");function _(e,t,o){if(J&&zt){let a=ct.get(e);a||ct.set(e,a=new Map);let n=a.get(o);n||(a.set(o,n=new Zt),n.map=a,n.key=o),n.track()}}function k(e,t,o,a,n,i){const s=ct.get(e);if(!s)return;const r=u=>{u&&u.trigger()};if(st(),t==="clear")s.forEach(r);else{const u=B(e),d=u&&it(o);if(u&&o==="length"){const h=Number(a);s.forEach((g,b)=>{(b==="length"||b===K||!H(b)&&b>=h)&&r(g)})}else switch((o!==void 0||s.has(void 0))&&r(s.get(o)),d&&r(s.get(K)),t){case"add":u?d&&r(s.get("length")):(r(s.get(N)),X(e)&&r(s.get(ut)));break;case"delete":u||(r(s.get(N)),X(e)&&r(s.get(ut)));break;case"set":X(e)&&r(s.get(N));break}}lt()}function $(e){const t=v(e);return t===e?t:(_(t,"iterate",K),O(e)?t:t.map(E))}function dt(e){return _(e=v(e),"iterate",K),e}const te={__proto__:null,[Symbol.iterator](){return ht(this,Symbol.iterator,E)},concat(...e){return $(this).concat(...e.map(t=>B(t)?$(t):t))},entries(){return ht(this,"entries",e=>(e[1]=E(e[1]),e))},every(e,t){return A(this,"every",e,t,void 0,arguments)},filter(e,t){return A(this,"filter",e,t,o=>o.map(E),arguments)},find(e,t){return A(this,"find",e,t,E,arguments)},findIndex(e,t){return A(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return A(this,"findLast",e,t,E,arguments)},findLastIndex(e,t){return A(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return A(this,"forEach",e,t,void 0,arguments)},includes(...e){return mt(this,"includes",e)},indexOf(...e){return mt(this,"indexOf",e)},join(e){return $(this).join(e)},lastIndexOf(...e){return mt(this,"lastIndexOf",e)},map(e,t){return A(this,"map",e,t,void 0,arguments)},pop(){return j(this,"pop")},push(...e){return j(this,"push",e)},reduce(e,...t){return Rt(this,"reduce",e,t)},reduceRight(e,...t){return Rt(this,"reduceRight",e,t)},shift(){return j(this,"shift")},some(e,t){return A(this,"some",e,t,void 0,arguments)},splice(...e){return j(this,"splice",e)},toReversed(){return $(this).toReversed()},toSorted(e){return $(this).toSorted(e)},toSpliced(...e){return $(this).toSpliced(...e)},unshift(...e){return j(this,"unshift",e)},values(){return ht(this,"values",E)}};function ht(e,t,o){const a=dt(e),n=a[t]();return a!==e&&!O(e)&&(n._next=n.next,n.next=()=>{const i=n._next();return i.value&&(i.value=o(i.value)),i}),n}const ee=Array.prototype;function A(e,t,o,a,n,i){const s=dt(e),r=s!==e&&!O(e),u=s[t];if(u!==ee[t]){const g=u.apply(e,i);return r?E(g):g}let d=o;s!==e&&(r?d=function(g,b){return o.call(this,E(g),b,e)}:o.length>2&&(d=function(g,b){return o.call(this,g,b,e)}));const h=u.call(s,d,a);return r&&n?n(h):h}function Rt(e,t,o,a){const n=dt(e);let i=o;return n!==e&&(O(e)?o.length>3&&(i=function(s,r,u){return o.call(this,s,r,u,e)}):i=function(s,r,u){return o.call(this,s,E(r),u,e)}),n[t](i,...a)}function mt(e,t,o){const a=v(e);_(a,"iterate",K);const n=a[t](...o);return(n===-1||n===!1)&&ge(o[0])?(o[0]=v(o[0]),a[t](...o)):n}function j(e,t,o=[]){Qt(),st();const a=v(e)[t].apply(e,o);return lt(),Jt(),a}const oe=Kt("__proto__,__v_isRef,__isVue"),_t=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(H));function ne(e){H(e)||(e=String(e));const t=v(this);return _(t,"has",e),t.hasOwnProperty(e)}class Et{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,a){if(o==="__v_skip")return t.__v_skip;const n=this._isReadonly,i=this._isShallow;if(o==="__v_isReactive")return!n;if(o==="__v_isReadonly")return n;if(o==="__v_isShallow")return i;if(o==="__v_raw")return a===(n?i?me:Pt:i?he:At).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(a)?t:void 0;const s=B(t);if(!n){let u;if(s&&(u=te[o]))return u;if(o==="hasOwnProperty")return ne}const r=Reflect.get(t,o,Y(t)?t:a);return(H(o)?_t.has(o):oe(o))||(n||_(t,"get",o),i)?r:Y(r)?s&&it(o)?r:r.value:z(r)?n?Mt(r):pt(r):r}}class ae extends Et{constructor(t=!1){super(!1,t)}set(t,o,a,n){let i=t[o];if(!this._isShallow){const u=U(i);if(!O(a)&&!U(a)&&(i=v(i),a=v(a)),!B(t)&&Y(i)&&!Y(a))return u?!1:(i.value=a,!0)}const s=B(t)&&it(o)?Number(o)<t.length:at(t,o),r=Reflect.set(t,o,a,Y(t)?t:n);return t===v(n)&&(s?Q(a,i)&&k(t,"set",o,a):k(t,"add",o,a)),r}deleteProperty(t,o){const a=at(t,o);t[o];const n=Reflect.deleteProperty(t,o);return n&&a&&k(t,"delete",o,void 0),n}has(t,o){const a=Reflect.has(t,o);return(!H(o)||!_t.has(o))&&_(t,"has",o),a}ownKeys(t){return _(t,"iterate",B(t)?"length":N),Reflect.ownKeys(t)}}class ie extends Et{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const re=new ae,se=new ie,ft=e=>e,Z=e=>Reflect.getPrototypeOf(e);function le(e,t,o){return function(...a){const n=this.__v_raw,i=v(n),s=X(i),r=e==="entries"||e===Symbol.iterator&&s,u=e==="keys"&&s,d=n[e](...a),h=o?ft:t?gt:E;return!t&&_(i,"iterate",u?ut:N),{next(){const{value:g,done:b}=d.next();return b?{value:g,done:b}:{value:r?[h(g[0]),h(g[1])]:h(g),done:b}},[Symbol.iterator](){return this}}}}function tt(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function ce(e,t){const o={get(n){const i=this.__v_raw,s=v(i),r=v(n);e||(Q(n,r)&&_(s,"get",n),_(s,"get",r));const{has:u}=Z(s),d=t?ft:e?gt:E;if(u.call(s,n))return d(i.get(n));if(u.call(s,r))return d(i.get(r));i!==s&&i.get(n)},get size(){const n=this.__v_raw;return!e&&_(v(n),"iterate",N),Reflect.get(n,"size",n)},has(n){const i=this.__v_raw,s=v(i),r=v(n);return e||(Q(n,r)&&_(s,"has",n),_(s,"has",r)),n===r?i.has(n):i.has(n)||i.has(r)},forEach(n,i){const s=this,r=s.__v_raw,u=v(r),d=t?ft:e?gt:E;return!e&&_(u,"iterate",N),r.forEach((h,g)=>n.call(i,d(h),d(g),s))}};return jt(o,e?{add:tt("add"),set:tt("set"),delete:tt("delete"),clear:tt("clear")}:{add(n){!t&&!O(n)&&!U(n)&&(n=v(n));const i=v(this);return Z(i).has.call(i,n)||(i.add(n),k(i,"add",n,n)),this},set(n,i){!t&&!O(i)&&!U(i)&&(i=v(i));const s=v(this),{has:r,get:u}=Z(s);let d=r.call(s,n);d||(n=v(n),d=r.call(s,n));const h=u.call(s,n);return s.set(n,i),d?Q(i,h)&&k(s,"set",n,i):k(s,"add",n,i),this},delete(n){const i=v(this),{has:s,get:r}=Z(i);let u=s.call(i,n);u||(n=v(n),u=s.call(i,n)),r&&r.call(i,n);const d=i.delete(n);return u&&k(i,"delete",n,void 0),d},clear(){const n=v(this),i=n.size!==0,s=n.clear();return i&&k(n,"clear",void 0,void 0),s}}),["keys","values","entries",Symbol.iterator].forEach(n=>{o[n]=le(n,e,t)}),o}function It(e,t){const o=ce(e,t);return(a,n,i)=>n==="__v_isReactive"?!e:n==="__v_isReadonly"?e:n==="__v_raw"?a:Reflect.get(at(o,n)&&n in a?o:a,n,i)}const ue={get:It(!1,!1)},de={get:It(!0,!1)},At=new WeakMap,he=new WeakMap,Pt=new WeakMap,me=new WeakMap;function fe(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function pe(e){return e.__v_skip||!Object.isExtensible(e)?0:fe(Xt(e))}function pt(e){return U(e)?e:kt(e,!1,re,ue,At)}function Mt(e){return kt(e,!0,se,de,Pt)}function kt(e,t,o,a,n){if(!z(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=pe(e);if(i===0)return e;const s=n.get(e);if(s)return s;const r=new Proxy(e,i===2?a:o);return n.set(e,r),r}function U(e){return!!(e&&e.__v_isReadonly)}function O(e){return!!(e&&e.__v_isShallow)}function ge(e){return e?!!e.__v_raw:!1}function v(e){const t=e&&e.__v_raw;return t?v(t):e}const E=e=>z(e)?pt(e):e,gt=e=>z(e)?Mt(e):e;function Y(e){return e?e.__v_isRef===!0:!1}/*!
 * pinia v3.0.3
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */var Lt;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Lt||(Lt={}));const wt=()=>({feishu:{label:"飞书多维表格设置",feishu_base_url:{value:"",max:200,defalutVaue:"",label:"多维表格URL",placeholder:"多维表格URL 例如: https://mideqnf1p7d.feishu.cn/base/TAAsbKNniaMaodss84tcEQSun3f?table=tbllpvh8BykaNQBM&view=vewvd05oOX"}},dignding:{label:"钉钉AI表格设置",appKey:{value:"",max:100,defalutVaue:"",label:"appKey",placeholder:"appKey"},appSecret:{value:"",max:100,defalutVaue:"",label:"appSecret",placeholder:"appSecret"},baseId:{value:"",max:100,defalutVaue:"",label:"baseId",placeholder:"baseId 文档Id"},phone:{value:"",max:100,defalutVaue:"",label:"手机号",placeholder:"钉钉用户绑定的手机号码"}},douyin:{label:"抖音设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxUserVideoCount:{value:100,max:200,defalutVaue:100,label:"最大用户视频数量",placeholder:"最大用户视频数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},xiaohongshu:{label:"小红书设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxUserNoteCount:{value:100,max:200,defalutVaue:100,label:"最大用户笔记数量",placeholder:"最大用户笔记数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},jd:{label:"京东设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},taobao:{label:"淘宝设置",maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},sycm_taobao:{label:"生意参谋设置",maxOverviewDataCount:{value:100,max:200,defalutVaue:100,label:"最大客户概况数量",placeholder:"最大客户概况数量"},maxCustomerTripDataCount:{value:100,max:200,defalutVaue:100,label:"最大客户旅程数量",placeholder:"最大客户旅程数量"},maxCustomerTripGoodsDataCount:{value:100,max:200,defalutVaue:100,label:"最大客户旅程商品数量",placeholder:"最大客户旅程商品数量"}},one_alimama:{label:"阿里妈妈万象台设置",maxGoodsListCount:{value:100,max:200,defalutVaue:100,label:"最大商品数量",placeholder:"最大商品数量"}},tiktok:{label:"tiktok设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxUserVideoCount:{value:100,max:200,defalutVaue:100,label:"最大用户视频数量",placeholder:"最大用户视频数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},youtube:{label:"tiktok设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxUserVideoCount:{value:100,max:200,defalutVaue:100,label:"最大用户视频数量",placeholder:"最大用户视频数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}}});let we=wt();pt(we);const Nt="__setting",be=async()=>{var t=(await S.storage.local.get([Nt]))[Nt];if(t){const a=t;var o=wt();return Object.keys(o).forEach(n=>{n in a||(a[n]=o[n])}),a}else return wt()};class bt{constructor(){l(this,"actualProductionRatio",0);l(this,"cost",0);l(this,"totalDealCount",0);l(this,"totalDealAmount",0);l(this,"collectionCount",0);l(this,"impressions",0);l(this,"clicks",0);l(this,"clickRate",0);l(this,"averageClickCost",0);l(this,"thousandImpressionsCost",0);l(this,"boostImpressions",0);l(this,"boostClickCount",0);l(this,"clickConversionRate",0);l(this,"directDealAmount",0);l(this,"directDealCount",0);l(this,"collectionAddCartCount",0);l(this,"presaleDealAmount",0);l(this,"presaleDealCount",0);l(this,"directPresaleDealAmount",0);l(this,"directPresaleDealCount",0);l(this,"presaleProductionRatio",0);l(this,"shoppingCartCount",0);this.actualProductionRatio=0,this.cost=0,this.totalDealCount=0,this.totalDealAmount=0,this.collectionCount=0,this.impressions=0,this.clicks=0,this.clickRate=0,this.averageClickCost=0,this.thousandImpressionsCost=0,this.boostImpressions=0,this.boostClickCount=0,this.clickConversionRate=0,this.directDealAmount=0,this.directDealCount=0,this.collectionAddCartCount=0,this.presaleDealAmount=0,this.presaleDealCount=0,this.directPresaleDealAmount=0,this.directPresaleDealCount=0,this.presaleProductionRatio=0,this.shoppingCartCount=0}}class ye extends bt{constructor(){super();l(this,"date","");this.date=""}}class ve{constructor(){l(this,"radarName","");l(this,"radarSuggestion","");this.radarName="",this.radarSuggestion=""}}class xe{constructor(){l(this,"base",0);l(this,"start",0);this.base=0,this.start=0}}class Te{constructor(){l(this,"pid","");l(this,"date","");l(this,"cost",0);l(this,"impressions",0);l(this,"clicks",0);l(this,"totalDealAmount",0);l(this,"actualProductionRatio",0);l(this,"presaleProductionRatio",0);l(this,"totalDealCount",0);l(this,"netDealAmount",0);l(this,"netDealCount",0);l(this,"netActualProductionRatio",0);this.pid="",this.date="",this.cost=0,this.impressions=0,this.clicks=0,this.totalDealAmount=0,this.actualProductionRatio=0,this.presaleProductionRatio=0,this.totalDealCount=0,this.netDealAmount=0,this.netDealCount=0,this.netActualProductionRatio=0}}class Se extends bt{constructor(){super();l(this,"id","");l(this,"productId","");l(this,"productName","");l(this,"productUrl","");l(this,"productImage","");l(this,"planName","");l(this,"planId","");l(this,"radar",[]);l(this,"dailyBudget");l(this,"targetProductionRatio",0);l(this,"baseProductionRatio",0);l(this,"oneKeyStartDay30List",[]);this.id="",this.productId="",this.productName="",this.productUrl="",this.productImage="",this.planName="",this.planId="",this.radar=[],this.dailyBudget=void 0,this.targetProductionRatio=0,this.baseProductionRatio=0,this.oneKeyStartDay30List=[]}}class Ce{constructor(){l(this,"dataSummary");l(this,"dataTableList",[]);l(this,"productList",[]);l(this,"timeFrom","");l(this,"timeTo","");l(this,"cycle",-1);l(this,"cycleText","");this.dataSummary=void 0,this.dataTableList=[],this.productList=[],this.timeFrom="",this.timeTo="",this.cycle=-1,this.cycleText=""}}class De{constructor(){l(this,"today");l(this,"yesterday");l(this,"days7");l(this,"days15");l(this,"days30");l(this,"lastWeek");l(this,"thisMonth");l(this,"lastMonth");this.today=void 0,this.yesterday=void 0,this.days7=void 0,this.days15=void 0,this.days30=void 0,this.lastWeek=void 0,this.thisMonth=void 0,this.lastMonth=void 0}}const y={today:1,yesterday:2,days7:3,lastWeek:4,days15:5,thisMonth:6,days30:7,lastMonth:8};async function Re(){console.log("scraping alimama promotion data");const t=(await be()).one_alimama.maxGoodsListCount.value,o=await f.getUserInputNumber(1,"请输入数据范围，默认1，1:今日，2:昨天，3:近七日，4:上周，5:近15日，6:本月，7:近30日，8:上月",8);await Tt();const a=new _e(t);await a.init();const n=new De;return n.today=await a.getPromotionDataDetail(y.today,o),n.yesterday=await a.getPromotionDataDetail(y.yesterday,o),n.days7=await a.getPromotionDataDetail(y.days7,o),n.lastWeek=await a.getPromotionDataDetail(y.lastWeek,o),n.days15=await a.getPromotionDataDetail(y.days15,o),n.thisMonth=await a.getPromotionDataDetail(y.thisMonth,o),n.days30=await a.getPromotionDataDetail(y.days30,o),n.lastMonth=await a.getPromotionDataDetail(y.lastMonth,o),n}class _e{constructor(t){l(this,"totalDataCount",0);l(this,"datasSmmaryRootSelector");l(this,"dataTableRootSelector");l(this,"proudctRootSelector");l(this,"dataSummaryRoot");l(this,"dataTableRoot");l(this,"proudctRoot");l(this,"targetList",[]);l(this,"cycle");l(this,"timeFrom");l(this,"timeTo");l(this,"detail");this.totalDataCount=t}async init(){this.datasSmmaryRootSelector='div[mxv^="lineNumber"]>div[mxv^="fields"]>div>div',this.dataTableRootSelector='div[mxv^="lineNumber"]>div>div[mxv="listPrefix,fields"] div[mx-stickytable-wrapper="body"] table',this.proudctRootSelector='div[mxv="list,selectedTdList,emptyData,emptyText,checkedIds"] div[mx-stickytable-wrapper="body"] table tbody',this.dataSummaryRoot=await C(this.datasSmmaryRootSelector),this.dataTableRoot=null,this.proudctRoot=await C(this.proudctRootSelector),this.targetList=[this.dataSummaryRoot,this.proudctRoot];const t=await C('div[mxv^="params"][mx-view*="/common/fields"] span[mxv="curTab"]>span:nth-child(2)');t.parentElement.firstChild.classList.length>1&&t.click(),await this.selectAllFields('div.clearfix>span.mxgc-popover div[mxv="curTab"]>span>button[mxv="popData"]',this.dataSummaryRoot),await this.selectAllFields('div.clearfix>span.mxgc-popover div[mxv="tdList,selectedTdCodeList"] span>button[mxv="popData"]',this.proudctRoot)}getCycleText(){switch(this.cycle){case y.today:return"今日";case y.yesterday:return"昨日";case y.days7:return"近7日";case y.days15:return"近15日";case y.days30:return"近30日";case y.lastWeek:return"上周";case y.thisMonth:return"本月";case y.lastMonth:return"上月";default:return"本月"}}getTimeRangeByCycle(){const t={timeFrom:"",timeTo:""},o=new Date;let a=o,n=o;switch(this.cycle){case y.today:a=new Date(o.getFullYear(),o.getMonth(),o.getDate());break;case y.yesterday:a=new Date(o.getFullYear(),o.getMonth(),o.getDate()-1);break;case y.days7:a=new Date(o.getFullYear(),o.getMonth(),o.getDate()-7);break;case y.days15:a=new Date(o.getFullYear(),o.getMonth(),o.getDate()-15);break;case y.days30:a=new Date(o.getFullYear(),o.getMonth(),o.getDate()-30);break;case y.lastWeek:const i=o.getDay(),s=i===0?-6:1-i;let r=new Date(o);r.setDate(o.getDate()+s),r.setHours(0,0,0,0);const u=new Date(r);u.setDate(r.getDate()-7);const d=new Date(u);a=u,n=d;break;case y.thisMonth:a=new Date(o.getFullYear(),o.getMonth(),1);break;case y.lastMonth:a=new Date(o.getFullYear(),o.getMonth()-1,1),n=new Date(o.getFullYear(),o.getMonth(),0);break}return t.timeFrom=a.getFullYear()+"-"+(a.getMonth()+1+"").padStart(2,"0")+"-"+(a.getDate()+"").padStart(2,"0"),t.timeTo=n.getFullYear()+"-"+(n.getMonth()+1+"").padStart(2,"0")+"-"+(n.getDate()+"").padStart(2,"0"),t}sendMessage(t){t?f.sendMessage(`正在抓取全站推广-${this.getCycleText()}-${t}-数据`):f.sendMessage(`正在抓取全站推广-${this.getCycleText()}-数据`)}async selectAllFields(t,o){const a=await C(t);f.scrollToElement(a),a.click();const n='div[id^="wrapper_dlg_"] div.dialog-body-column-left>div:last-child>div:nth-child(odd) input[type="checkbox"]';await C(n),await f.sleep(100),document.querySelectorAll(n).forEach(i=>{i.checked||i.click()}),await f.sleep(1e3),await f.waitForElementTextChange(()=>{document.querySelector('div[id^="wrapper_dlg_"] div.dialog-footer>span:first-child').click()},o),await f.sleep(100)}async getPromotionDataDetail(t,o){if(t!=o)return;this.cycle=t,this.sendMessage("");const a=this.getTimeRangeByCycle();this.timeFrom=a.timeFrom,this.timeTo=a.timeTo,this.detail=new Ce,this.detail.timeFrom=a.timeFrom,this.detail.timeTo=a.timeTo,this.detail.cycle=t,this.detail.cycleText=this.getCycleText(),(await C("div[id^='trigger_mx'].mxgc-dropdown-box>div>div")).click();const i=await C(`.mx-output-bottom.mx-output-open .display-grid.gcg4.grg4>span:nth-child(${t})`);await f.waitForElementListTextChange(async()=>{i.click()},this.targetList,5e3);const s=document.querySelector('div[mxv^="lineNumber"] div[mx-view*="mx-effects/toggle"]>a');return s.classList.length==1&&s.click(),(await C('div[mxv="detailMode"] div[data-index="1"]')).click(),this.dataTableRoot=await C(this.dataTableRootSelector),await f.sleep(100),await Tt(),this.detail.dataSummary=await this.getDataSummary(),await f.sleep(1e3),this.detail.dataTableList=await this.getDataTableList(),await f.sleep(1e3),this.detail.productList=await this.getProductList(),await f.sleep(1e3),this.detail}async getDataSummary(){const t=new bt;f.scrollToElement(this.dataSummaryRoot),this.sendMessage("汇总");const o=document.querySelectorAll(`${this.datasSmmaryRootSelector} div[mxv="groups"]>div:first-child>span:nth-child(2)`),a=n=>{for(let i of o)if(i.parentElement.children[0].children[0].textContent.includes(n))return f.getElementTextToNumber(i);return null};return t.actualProductionRatio=a("实际投产比"),t.cost=a("花费"),t.totalDealCount=a("总成交笔数"),t.totalDealAmount=a("总成交金额"),t.collectionCount=a("收藏宝贝数"),t.impressions=a("展现量"),t.clicks=a("点击量"),t.clickRate=a("点击率"),t.averageClickCost=a("平均点击花费"),t.thousandImpressionsCost=a("千次展现花费"),t.boostImpressions=a("助推展现量"),t.boostClickCount=a("助推带动点击量"),t.clickConversionRate=a("点击转化率"),t.directDealAmount=a("直接成交金额"),t.directDealCount=a("直接成交笔数"),t.collectionAddCartCount=a("宝贝收藏加购数"),t.presaleDealAmount=a("总预售成交金额"),t.presaleDealCount=a("总预售成交笔数"),t.directPresaleDealAmount=a("直接预售成交金额"),t.directPresaleDealCount=a("直接预售成交笔数"),t.presaleProductionRatio=a("含预售投产比"),t.shoppingCartCount=a("总购物车数"),t}async getDataTableList(){const t=[];f.scrollToElement(this.dataTableRoot),this.sendMessage("数据汇总表格");const o=document.querySelectorAll('div[mxv^="lineNumber"]>div>div[mxv="listPrefix,fields"] div[mx-stickytable-wrapper="placeholder"] table thead tr th'),a=s=>{for(let r=0;r<o.length;r++)if(o[r].textContent.includes(s))return r;return-1},n=document.querySelectorAll(`${this.dataTableRootSelector} tbody>tr`),i=(s,r,u=!0)=>{const d=a(r);return d==-1?"":f.getTextNodeValue(s.querySelector(`td:nth-child(${d+1})>div`),u)};for(const s of n){const r=new ye;r.date=f.getElementText(s.querySelector("td:nth-child(1)")).trim(),r.actualProductionRatio=i(s,"实际投产比"),r.cost=i(s,"花费"),r.totalDealCount=i(s,"总成交笔数"),r.totalDealAmount=i(s,"总成交金额"),r.collectionCount=i(s,"收藏宝贝数"),r.impressions=i(s,"展现量"),r.clicks=i(s,"点击量"),r.clickRate=i(s,"点击率"),r.averageClickCost=i(s,"平均点击花费"),r.thousandImpressionsCost=i(s,"千次展现花费"),r.boostImpressions=i(s,"助推展现量"),r.boostClickCount=i(s,"助推带动点击量"),r.clickConversionRate=i(s,"点击转化率"),r.directDealAmount=i(s,"直接成交金额"),r.directDealCount=i(s,"直接成交笔数"),r.collectionAddCartCount=i(s,"宝贝收藏加购数"),r.presaleDealAmount=i(s,"总预售成交金额"),r.presaleDealCount=i(s,"总预售成交笔数"),r.directPresaleDealAmount=i(s,"直接预售成交金额"),r.directPresaleDealCount=i(s,"直接预售成交笔数"),r.presaleProductionRatio=i(s,"含预售投产比"),r.shoppingCartCount=i(s,"总购物车数"),t.push(r)}return t}closeDialog(){const t=document.querySelectorAll('div[id^="mask_dlg_"]');for(const a of t)a.remove();const o=document.querySelectorAll('div[id^="wrapper_dlg_"]');for(const a of o)a.remove();document.body.offsetHeight}async getProductList(){const t=[];f.scrollToElement(this.proudctRoot),this.sendMessage("商品列表");const o=document.querySelectorAll('div[mxv="list,selectedTdList,emptyData,emptyText,checkedIds"] div[mx-stickytable-wrapper="placeholder"] table thead tr th'),a=u=>{for(let d=0;d<o.length;d++)if(o[d].textContent.includes(u))return d;return-1},n=(u,d,h=!0)=>{const g=a(d);return g==-1?"":h?f.getElementTextToNumber(u.children[g]):f.getElementText(u.children[g])},i=async u=>{this.sendMessage("商品列表");const d=document.querySelectorAll(`${this.proudctRootSelector}>tr`),h=[],g=[];for(let b=0;b<d.length-1;b+=2){const m=d[b];if(b+1<d.length-1){const p=d[b+1];h.push({dataTr:m,oneKeyTr:p}),g.push(m.children[3])}}u==!1&&(await f.waitForElementListTextChange(()=>{},g,1e4,!1),await f.sleep(500)),console.log("xxx",h,d);for(const b of h){if(t.length>=this.totalDataCount)break;const m=new Se;m.id=f.simpleUUID();const p=b.dataTr;f.scrollToElement(p),await f.waitElementInViewportUseObserver(p),m.productId=f.getElementText(p.children[2].querySelector(".nowrap>span:first-child")).split("：")[1],m.productName=f.getElementText(p.children[2].querySelector(".multi-ellipsis a")),m.productUrl=p.children[2].querySelector(".multi-ellipsis a").href,m.productImage=p.children[2].querySelector("img").src,m.planName=f.getElementText(p.children[2].querySelector(".ellipsis a")),m.planId=f.getElementText(p.children[2].querySelector(".nowrap>span:last-child")).split("：")[1],m.radar=[];const P=p.children[3].querySelector("span>div");if(P){f.elementHover(P,!0);const w=`div[data-spmc-params^="bizCode=onebpSite&campaignId=${m.planId}"]`,W=await(await C(w)).querySelectorAll(`${w}>div`);for(const F of W){const L=new ve;L.radarName=f.getElementText(F.children[0]),L.radarSuggestion=f.getElementText(F.children[1]),m.radar.push(L)}f.elementHover(P,!1)}const I=new xe;I.base=f.getElementTextToNumber(p.children[4].querySelector("span.mxgc-popover>div:nth-child(1)")),I.start=f.getElementTextToNumber(p.children[4].querySelector("span.mxgc-popover>div:nth-child(2)")),m.dailyBudget=I,m.targetProductionRatio=f.getElementTextToNumber(p.children[5].querySelector('div[mxv="list"]>div'));const D=n(p,"实际投产比",!1);D.includes("基础")?(m.actualProductionRatio=+D.split("基础")[0].replace(/[^\d-.]/g,""),m.baseProductionRatio=+D.split("基础")[1].replace(/[^\d-.]/g,"")):m.actualProductionRatio=n(p,"实际投产比",!0),m.cost=n(p,"花费"),m.totalDealCount=n(p,"总成交笔数"),m.totalDealAmount=n(p,"总成交金额"),m.collectionCount=n(p,"收藏宝贝数"),m.impressions=n(p,"展现量"),m.clicks=n(p,"点击量"),m.clickRate=n(p,"点击率"),m.averageClickCost=n(p,"平均点击花费"),m.thousandImpressionsCost=n(p,"千次展现花费"),m.boostImpressions=n(p,"助推展现量"),m.boostClickCount=n(p,"助推带动点击量"),m.clickConversionRate=n(p,"点击转化率"),m.directDealAmount=n(p,"直接成交金额"),m.directDealCount=n(p,"直接成交笔数"),m.collectionAddCartCount=n(p,"宝贝收藏加购数"),m.presaleDealAmount=n(p,"总预售成交金额"),m.presaleDealCount=n(p,"总预售成交笔数"),m.directPresaleDealAmount=n(p,"直接预售成交金额"),m.directPresaleDealCount=n(p,"直接预售成交笔数"),m.presaleProductionRatio=n(p,"含预售投产比"),m.shoppingCartCount=n(p,"总购物车数"),this.closeDialog(),b.oneKeyTr.querySelector('span[data-spm$="quickLift2"]:nth-child(2)>span>button').click();const T='div[id^="wrapper_dlg_"]>div[id^="dlg_"]';await C(T);let c=0;const x=5;for(;c<x;)try{m.oneKeyStartDay30List=await this.getOneKeyStartData(y.days30,T,m.id,m.productId,c);break}catch(w){c++,console.error("一键起量数据异常，尝试实数：",m.productId,c,w),this.closeDialog(),b.oneKeyTr.querySelector('span[data-spm$="quickLift2"]:nth-child(2)>span>button').click()}t.push(m)}},s=document.querySelector('[mxv="pageSizes"]>div>div>a:first-of-type');window.getComputedStyle(s).cursor!="not-allowed"?(await f.waitForElementTextChange(()=>{document.querySelector('[mxv="pageSizes"]>div>div>a:nth-of-type(2)').click()},this.proudctRoot,5e3),await f.sleep(1e3),await i(!1)):(await f.sleep(1e3),await i(!0));const r=document.querySelectorAll('[mxv="pageSizes"]>div>div>a.mc-iconfont')[1];for(;window.getComputedStyle(r).cursor!="not-allowed"&&t.length<this.totalDataCount;)await f.waitForElementTextChange(()=>{r.click()},this.proudctRoot,5e3),await f.sleep(1e3),await i(!1);return t}async getOneKeyStartData(t,o,a,n,i){console.log("一键起量数据开始获取,打开弹窗",n,i),await f.sleep(10);const s=[];this.sendMessage("一键起量"),await C(o,1e4);let r=0;t===y.yesterday?r=1:t===y.days7?r=2:t===y.days15?r=3:t===y.days30&&(r=4);const u=await C(`${o}>span`,1e4);try{const d=await C(`${o} div[id^="cnt_dlg_"] div[mxv="tabs,selectedTab"] a:last-child`,1e4);console.log("一键起量按钮！",d),d.click(),(await C(`${o} div[id^="cnt_dlg_"] div.mxgc-dropdown-box:first-child>div>div:nth-child(${r})`,1e4)).click(),(await C(`${o} div[mxv="currentView"] div[data-index="1"]`,1e4)).click();const b=await C(`${o} div[mx-stickytable-wrapper="placeholder"] table thead`,1e4),m=await C(`${o} div[mx-stickytable-wrapper="body"] table tbody`,1e4);await f.sleep(100);const p=b.querySelectorAll("tr:first-child th"),P=T=>{for(let c=0;c<p.length;c++)if(p[c].textContent.includes(T))return c;return-1},I=m.querySelectorAll(`${o} div[mx-stickytable-wrapper="body"] table tbody>tr`),D=(T,c,x=!0)=>{const w=P(c);return w==-1?"":x?f.getElementTextToNumber(T.children[w]):f.getElementText(T.children[w])};for(const T of I){const c=new Te;c.pid=a,f.scrollToElement(T),c.date=D(T,"日期",!1).trim(),c.cost=D(T,"花费"),c.impressions=D(T,"展现量"),c.clicks=D(T,"点击量"),c.totalDealAmount=D(T,"总成交金额"),c.actualProductionRatio=D(T,"实际投产比"),c.presaleProductionRatio=D(T,"含预售投产比"),c.totalDealCount=D(T,"总成交笔数"),c.netDealAmount=D(T,"净成交金额"),c.netDealCount=D(T,"净成交笔数"),c.netActualProductionRatio=D(T,"净实际投产比"),s.push(c)}}catch(d){throw d}finally{await f.sleep(500),u.click(),this.closeDialog(),await f.sleep(100),console.log("一键起量数据获取完成,关闭弹窗",n,i)}return s}}const Ee={matches:["https://one.alimama.com/index.html*"],main:e=>{console.log("Hello one.alimama content."),Wt(Ie)}};async function Ie(e,t){(e===V.taobao.domain||e===V.tmall.domain)&&document.querySelector(".baxia-dialog")&&document.querySelector(".baxia-dialog").remove();let o,a="unsupported";console.log("当前域名:",e),console.log("当前URL:",t),t.includes("/manage/onesite")?(console.log("检测到阿里妈妈万象台全站推广页面，开始抓取全站推广数据"),o=await Re(),a="onesite"):console.log("不是支持的阿里妈妈万象台类型，抓取跳过");const n=new Date().toLocaleString(),i={domain:e,type:a,data:o,fetchTime:n};return console.log("抓取结果:",i),i}function et(e,...t){}const Ae={debug:(...e)=>et(console.debug,...e),log:(...e)=>et(console.log,...e),warn:(...e)=>et(console.warn,...e),error:(...e)=>et(console.error,...e)},nt=class nt extends Event{constructor(t,o){super(nt.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=o}};l(nt,"EVENT_NAME",vt("wxt:locationchange"));let yt=nt;function vt(e){var t;return`${(t=S==null?void 0:S.runtime)==null?void 0:t.id}:one_alimama:${e}`}function Pe(e){let t,o;return{run(){t==null&&(o=new URL(location.href),t=e.setInterval(()=>{let a=new URL(location.href);a.href!==o.href&&(window.dispatchEvent(new yt(a,o)),o=a)},1e3))}}}const G=class G{constructor(t,o){l(this,"isTopFrame",window.self===window.top);l(this,"abortController");l(this,"locationWatcher",Pe(this));l(this,"receivedMessageIds",new Set);this.contentScriptName=t,this.options=o,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return S.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,o){const a=setInterval(()=>{this.isValid&&t()},o);return this.onInvalidated(()=>clearInterval(a)),a}setTimeout(t,o){const a=setTimeout(()=>{this.isValid&&t()},o);return this.onInvalidated(()=>clearTimeout(a)),a}requestAnimationFrame(t){const o=requestAnimationFrame((...a)=>{this.isValid&&t(...a)});return this.onInvalidated(()=>cancelAnimationFrame(o)),o}requestIdleCallback(t,o){const a=requestIdleCallback((...n)=>{this.signal.aborted||t(...n)},o);return this.onInvalidated(()=>cancelIdleCallback(a)),a}addEventListener(t,o,a,n){var i;o==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),(i=t.addEventListener)==null||i.call(t,o.startsWith("wxt:")?vt(o):o,a,{...n,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),Ae.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:G.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){var i,s,r;const o=((i=t.data)==null?void 0:i.type)===G.SCRIPT_STARTED_MESSAGE_TYPE,a=((s=t.data)==null?void 0:s.contentScriptName)===this.contentScriptName,n=!this.receivedMessageIds.has((r=t.data)==null?void 0:r.messageId);return o&&a&&n}listenForNewerScripts(t){let o=!0;const a=n=>{if(this.verifyScriptStartedEvent(n)){this.receivedMessageIds.add(n.data.messageId);const i=o;if(o=!1,i&&(t!=null&&t.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",a),this.onInvalidated(()=>removeEventListener("message",a))}};l(G,"SCRIPT_STARTED_MESSAGE_TYPE",vt("wxt:content-script-started"));let xt=G;function qe(){}function ot(e,...t){}const Me={debug:(...e)=>ot(console.debug,...e),log:(...e)=>ot(console.log,...e),warn:(...e)=>ot(console.warn,...e),error:(...e)=>ot(console.error,...e)};return(async()=>{try{const{main:e,...t}=Ee,o=new xt("one_alimama",t);return await e(o)}catch(e){throw Me.error('The content script "one_alimama" crashed on startup!',e),e}})()}();
onealimama;
