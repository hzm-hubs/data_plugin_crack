var baidu=function(){"use strict";var A=Object.defineProperty;var F=(l,r,c)=>r in l?A(l,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):l[r]=c;var a=(l,r,c)=>F(l,typeof r!="symbol"?r+"":r,c);var f,S;function l(e){return e}const r={matches:["*://*.baidu.com/*"],main(e){console.log("Hello baidu content")}},u=(S=(f=globalThis.browser)==null?void 0:f.runtime)!=null&&S.id?globalThis.browser:globalThis.chrome;function h(e,...t){}const I={debug:(...e)=>h(console.debug,...e),log:(...e)=>h(console.log,...e),warn:(...e)=>h(console.warn,...e),error:(...e)=>h(console.error,...e)},m=class m extends Event{constructor(t,i){super(m.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=i}};a(m,"EVENT_NAME",w("wxt:locationchange"));let v=m;function w(e){var t;return`${(t=u==null?void 0:u.runtime)==null?void 0:t.id}:baidu:${e}`}function T(e){let t,i;return{run(){t==null&&(i=new URL(location.href),t=e.setInterval(()=>{let n=new URL(location.href);n.href!==i.href&&(window.dispatchEvent(new v(n,i)),i=n)},1e3))}}}const d=class d{constructor(t,i){a(this,"isTopFrame",window.self===window.top);a(this,"abortController");a(this,"locationWatcher",T(this));a(this,"receivedMessageIds",new Set);this.contentScriptName=t,this.options=i,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return u.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,i){const n=setInterval(()=>{this.isValid&&t()},i);return this.onInvalidated(()=>clearInterval(n)),n}setTimeout(t,i){const n=setTimeout(()=>{this.isValid&&t()},i);return this.onInvalidated(()=>clearTimeout(n)),n}requestAnimationFrame(t){const i=requestAnimationFrame((...n)=>{this.isValid&&t(...n)});return this.onInvalidated(()=>cancelAnimationFrame(i)),i}requestIdleCallback(t,i){const n=requestIdleCallback((...s)=>{this.signal.aborted||t(...s)},i);return this.onInvalidated(()=>cancelIdleCallback(n)),n}addEventListener(t,i,n,s){var o;i==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),(o=t.addEventListener)==null||o.call(t,i.startsWith("wxt:")?w(i):i,n,{...s,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),I.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:d.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){var o,E,p;const i=((o=t.data)==null?void 0:o.type)===d.SCRIPT_STARTED_MESSAGE_TYPE,n=((E=t.data)==null?void 0:E.contentScriptName)===this.contentScriptName,s=!this.receivedMessageIds.has((p=t.data)==null?void 0:p.messageId);return i&&n&&s}listenForNewerScripts(t){let i=!0;const n=s=>{if(this.verifyScriptStartedEvent(s)){this.receivedMessageIds.add(s.data.messageId);const o=i;if(i=!1,o&&(t!=null&&t.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",n),this.onInvalidated(()=>removeEventListener("message",n))}};a(d,"SCRIPT_STARTED_MESSAGE_TYPE",w("wxt:content-script-started"));let b=d;function M(){}function g(e,...t){}const N={debug:(...e)=>g(console.debug,...e),log:(...e)=>g(console.log,...e),warn:(...e)=>g(console.warn,...e),error:(...e)=>g(console.error,...e)};return(async()=>{try{const{main:e,...t}=r,i=new b("baidu",t);return await e(i)}catch(e){throw N.error('The content script "baidu" crashed on startup!',e),e}})()}();
baidu;
