var sycmtaobao=function(){"use strict";var oo=Object.defineProperty;var no=(k,N,v)=>N in k?oo(k,N,{enumerable:!0,configurable:!0,writable:!0,value:v}):k[N]=v;var a=(k,N,v)=>no(k,typeof N!="symbol"?N+"":N,v);var re,se;function k(e){return e}const v=(se=(re=globalThis.browser)==null?void 0:re.runtime)!=null&&se.id?globalThis.browser:globalThis.chrome,B={"sycm.taobao":{name:"生意参谋",domain:"sycm.taobao",fullDomain:"sycm.taobao.com"},"one.alimama":{name:"阿里妈妈万象台",domain:"one.alimama",fullDomain:"one.alimama.com"},taobao:{name:"淘宝",domain:"taobao",fullDomain:"taobao.com"},tmall:{name:"天猫",domain:"tmall",fullDomain:"tmall.com"},tmallhk:{name:"天猫国际",domain:"tmallhk",fullDomain:"tmall.hk"},douyin:{name:"抖音",domain:"douyin",fullDomain:"douyin.com"},xiaohongshu:{name:"小红书",domain:"xiaohongshu",fullDomain:"xiaohongshu.com"},jd:{name:"京东",domain:"jd",fullDomain:"jd.com"},tiktok:{name:"tiktok",domain:"tiktok",fullDomain:"tiktok.com"},youtube:{name:"youtube",domain:"youtube",fullDomain:"youtube.com"},other:{name:"其他",domain:"other",fullDomain:"other"}};function ie(e){console.log("getDomain",e),e||(e=window.location.href);for(let t in B)if(e.includes(B[t].fullDomain))return B[t].domain;return B.other.domain}function ae(e,t="data_"){return e&&e.indexOf("https://sycm.taobao.com/cc/customer/trip")===0?e="https://sycm.taobao.com/cc/customer/trip":e&&e.indexOf("https://sycm.taobao.com/cc/customer/overview")===0?e="https://sycm.taobao.com/cc/customer/overview":e&&e.indexOf("https://one.alimama.com/index.html#!/manage/onesite")===0&&(e="https://one.alimama.com/index.html#!/manage/onesite"),t+btoa(e)}function mt(){return new Promise(e=>{const t=document.body.scrollHeight,o=t/10;let r=0;const n=setInterval(()=>{r<t?(window.scrollTo(0,r),r+=o):(window.scrollTo(0,0),clearInterval(n),e(!0))},200)})}function tt(e,t=5e3){return new Promise((o,r)=>{console.log(`等待元素加载: ${e}, 超时: ${t}ms`);const n=document.querySelector(e);if(n)return o(n);const s=setTimeout(()=>{if(c){c.disconnect(),console.log(`等待元素超时: ${e}`);const i=document.querySelector(e);i?o(i):r(new Error(`等待元素超时: ${e}`))}},t),c=new MutationObserver((i,l)=>{const m=document.querySelector(e);m&&(clearTimeout(s),l.disconnect(),o(m))});c.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","data-e2e"]}),console.log("MutationObserver已启动")})}class ce{constructor(){a(this,"sleep",t=>new Promise(o=>setTimeout(o,t)));a(this,"runDelay",async(t,o)=>new Promise(r=>setTimeout(()=>{r(t())},o)));a(this,"sendMessage",t=>{v.runtime.sendMessage({action:"updateStatus",status:t})});a(this,"sendDataWithAction",(t,o)=>{v.runtime.sendMessage({action:o,data:t})});a(this,"openPopup",(t=-1)=>{v.runtime.sendMessage({action:"openPopup",windowId:t})});a(this,"openSidePanel",(t=-1)=>{v.runtime.sendMessage({action:"openSidePanel",windowId:t})});a(this,"elementHover",(t,o=!0)=>{t.dispatchEvent(new MouseEvent(o?"mouseover":"mouseout",{bubbles:!0}))});a(this,"setElementAnimation",t=>{const o="266A247A-6C68-4F89-8D11-B767B4E7A71C",r="animation_"+o.slice(0,8),n="class_"+o.slice(0,8);if(!document.head.querySelector(`style[data-id='${o}']`)){const s=document.createElement("style");s.type="text/css",s.setAttribute("data-id",o);const c=`
      @keyframes ${r}{
        to {  background-color :rgb(255, 0, 0);
              border: 1px solid blue;
              border-radius: 3px;
        }
      }
    `,i=`
      .${n} {
        animation: ${r} 0.5s ease-in-out 0s 2 alternate none;
      }
    `;s.innerHTML=c+i,document.head.appendChild(s)}return t.classList.remove(n),t.offsetHeight,t.classList.add(n),t});a(this,"waitForChildListChange",async(t,o,r=5e3)=>new Promise((n,s)=>{const c=setTimeout(()=>{i&&(i.disconnect(),console.log("等待元素更新超时: ",o,`超时时间：${r}ms`),n(!1))},r),i=new MutationObserver((l,m)=>{if(l.length>0)for(const d of l)if(d.type==="attributes")d.attributeName;else if(d.type==="childList"){clearTimeout(c),m.disconnect(),n(!0);return}else d.type});i.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0}),t&&t()}));a(this,"waitForElementTextChange",async(t,o,r=5e3)=>new Promise((n,s)=>{console.log("等待元素更新:",o,` 超时: ${r}ms`);const c=setTimeout(()=>{i&&(i.disconnect(),console.log("等待元素更新超时: ",o,`超时时间：${r}ms`),n(!1))},r),i=new MutationObserver((l,m)=>{if(l.length>0){for(const d of l)if(d.type==="attributes")d.attributeName;else if(d.type!=="childList"){if(d.type==="characterData"){clearTimeout(c),m.disconnect(),n(!0);return}}}});i.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0}),t&&t()}));a(this,"waitForElementAttrChange",async(t,o,r=5e3)=>new Promise((n,s)=>{console.log("等待元素属性更新:",o,` 超时: ${r}ms`);const c=setTimeout(()=>{i&&(i.disconnect(),console.log("等待元素属性更新超时: ",o,`超时时间：${r}ms`),n(!1))},r),i=new MutationObserver((l,m)=>{if(l.length>0)for(const d of l)if(d.type==="attributes"){d.attributeName,clearTimeout(c),m.disconnect(),n(!0);return}else d.type==="childList"||d.type});i.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0}),t&&t()}));a(this,"waitForElementListTextChange",async(t,o,r=5e3,n=!0)=>{let s=[];return new Promise((c,i)=>{o.forEach(l=>{this.waitForElementTextChange(()=>{},l,r).then(async m=>{s.push({target:l,result:m}),n?s.length===o.length&&c(s):s.length==1&&(await this.sleep(500),c(s))})}),t&&t()})});a(this,"waitForElementListAttrChange",async(t,o,r=5e3,n=!0)=>{let s=[];return new Promise((c,i)=>{o.forEach(l=>{this.waitForElementAttrChange(()=>{},l,r).then(async m=>{s.push({target:l,result:m}),n?s.length===o.length&&c(s):s.length==1&&(await this.sleep(500),c(s))})}),t&&t()})});a(this,"waitForElementRemove",async(t,o=5e3)=>new Promise((r,n)=>{const c=o/10;let i=0;const l=setInterval(()=>{if(!document.querySelector(t)){clearInterval(l),r(!0);return}i++,i<c?console.log("等待元素移除:",t,` 超时: ${o}ms`,`剩余时间：${o-i*10}ms`):(console.log("等待元素移除超时: ",t,`超时时间：${o}ms`),clearInterval(l),n(!1))},10)}));a(this,"scrollToElementTop",t=>{t.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})});a(this,"scrollToElement",t=>{t.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})});a(this,"scrollToElementBottom",t=>{t.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})});a(this,"ensureElementVisible",t=>{let o=t;for(;o&&o!==document.body;){const i=o.parentElement;if(!i)break;const l=i.scrollHeight>i.clientHeight,m=i.scrollWidth>i.clientWidth;if(l||m){const d=i.getBoundingClientRect(),h=o.getBoundingClientRect();l&&(h.top<d.top?i.scrollTop-=d.top-h.top:h.bottom>d.bottom&&(i.scrollTop+=h.bottom-d.bottom)),m&&(h.left<d.left?i.scrollLeft-=d.left-h.left:h.right>d.right&&(i.scrollLeft+=h.right-d.right))}o=i}const r=window.scrollY,n=r+window.innerHeight,s=t.offsetTop,c=s+t.offsetHeight;s<r?window.scrollTo({top:s,behavior:"smooth"}):c>n&&window.scrollTo({top:c-window.innerHeight,behavior:"smooth"})});a(this,"getTextNodeValue",(t,o=!1)=>{this.setElementAnimation(t);const r=Array.from(t.childNodes).filter(n=>n.nodeType===Node.TEXT_NODE).map(n=>n.textContent).join("");return o?+r.replace(/[^\d-.]/g,""):r});a(this,"getElementText",(t,o=!0)=>t?(o&&this.setElementAnimation(t),t.textContent):"");a(this,"getElementTextToNumber",(t,o=!0)=>{if(t){const r=this.getElementText(t,o).replace(/[^\d-.]/g,"");return r&&!isNaN(r)?+r:r}return 0});a(this,"getUserInputNumber",async(t=10,o="请输入最大数据条数，默认10条，最小1条，最大100条",r=100)=>{let n=await this.showInput(o,t,r);for(;n;){let s=0;if(!isNaN(n)&&(s=parseInt(n),s>0&&s<=r)){t=s;break}n=await this.showInput(o,t,r)}return t});a(this,"waitElementInViewportUseObserver",async(t,o=5e3)=>new Promise((r,n)=>{this.isElementInViewport(t)&&r(!0),setTimeout(()=>{r(!1),s.disconnect()},o);const s=new IntersectionObserver(c=>{c.forEach(async i=>{i.isIntersecting&&(r(!0),s.disconnect())})});if(!t)return n("元素不存在");this.scrollToElement(t),s.observe(t)}));a(this,"waitElementInViewportUseClientRect",async(t,o=!1,r=5e3)=>{new Promise(async(n,s)=>{if(!t||typeof t.getBoundingClientRect!="function")return n(!1);let c=null;const i=()=>{const h=t.getBoundingClientRect(),w=window.innerHeight||document.documentElement.clientHeight,f=window.innerWidth||document.documentElement.clientWidth;let T=!1;if(o)T=h.top>=0&&h.bottom<=w&&h.left>=0&&h.right<=f;else{const E=h.top<=w&&h.bottom>=0,x=h.left<=f&&h.right>=0;T=E&&x}T&&(c&&clearInterval(c),n(!0))},l=10,m=parseInt(r/l+"")>0?parseInt(r/l+""):1;let d=0;c=setInterval(()=>{d++,d>m?(c&&clearInterval(c),n(!1)):i()},l)})});a(this,"isElementInViewport",t=>{const o=t.getBoundingClientRect(),r=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth;return o.top<r&&o.bottom>0&&o.left<n&&o.right>0});a(this,"getItemTextAndLog",(t,o,r,n="")=>{const s=this.querySelector(t,o);let c=this.getElementText(s);return n&&(c=(s==null?void 0:s.getAttribute(n))||""),r&&!s&&console.log(r),c});a(this,"waitForResult",async(t,o=5e3)=>{const r=Math.floor(o/100);for(let n=0;n<r;n++){if(await t())return!0;await this.sleep(100)}return!1});a(this,"getNumberText",t=>{const o=t.match(/[\.\d]+(千万)?(万亿)?[万|亿|k|K|m|M|b|B]?/);return o?o[0]:t})}deepScroll(t){return new Promise((o,r)=>{const n=[],s={element:t.element||window,duration:t.duration||500,easing:t.easing||"easeInOutQuad",scrollContainers:n,left:t.left,top:t.top,target:t.target,callback:t.callback};function c(p){const y=[];let g=p;for(;g&&g!==document.documentElement;)i(g)&&y.push(g),g=g.parentElement;return l()&&y.push(window),y}function i(p){if(p===window||!(p instanceof HTMLElement))return!0;const y=getComputedStyle(p),g=y.overflowY==="auto"||y.overflowY==="scroll",S=y.overflowX==="auto"||y.overflowX==="scroll";return g&&p.scrollHeight>p.clientHeight||S&&p.scrollWidth>p.clientWidth}function l(){return document.documentElement.scrollHeight>window.innerHeight}function m(p,y){const g=y.getBoundingClientRect();if(p instanceof Window)return{top:d(g.top-window.pageYOffset+window.outerHeight,g.height,window.innerHeight,window.outerHeight),left:d(g.left-window.pageXOffset+window.outerWidth,g.width,window.innerWidth,window.outerWidth)};const S=p.getBoundingClientRect();return{top:d(g.top-S.top+p.scrollTop,g.height,p.clientHeight,p.scrollTop),left:d(g.left-S.left+p.scrollLeft,g.width,p.clientWidth,p.scrollLeft)}}function d(p,y,g,S){const j=S,V=S+g,O=p+y;return p>=j&&O<=V?S:p<j?p:O-g}function h(p){return p instanceof Window?window.pageYOffset:p.scrollTop}function w(p){return p instanceof Window?window.pageXOffset:p.scrollLeft}function f(p,y,g){p instanceof Window?window.scrollTo(g,y):(p.scrollTop=y,p.scrollLeft=g)}if(s.target){const p=c(s.target);let y=s.target;p.forEach(g=>{const S=m(g,y);s.scrollContainers.push({element:g,startTop:h(g),targetTop:S.top,startLeft:w(g),targetLeft:S.left}),y=g})}else s.scrollContainers.push({element:s.element,startTop:h(s.element),targetTop:s.top??h(s.element),startLeft:w(s.element),targetLeft:s.left??w(s.element)});const T={linear:p=>p,easeInQuad:p=>p*p,easeOutQuad:p=>p*(2-p),easeInOutQuad:p=>p<.5?2*p*p:-1+(4-2*p)*p},E=T[s.easing]||T.easeInOutQuad;let x=0;const A=()=>{var p;o(""),s.target,(p=s.callback)==null||p.call(s)},H=p=>{x||(x=p);const y=p-x,g=Math.min(y/s.duration,1),S=E(g);s.scrollContainers.forEach(({element:j,startTop:V,targetTop:O,startLeft:Q,targetLeft:z})=>{const Z=V+(O-V)*S,eo=Q+(z-Q)*S;f(j,Z,eo)}),y<s.duration?requestAnimationFrame(H):A()};requestAnimationFrame(H)})}async showInput(t,o,r){return new Promise((n,s)=>{v.runtime.sendMessage({action:"showInput",placeholder:t,defaultValue:o,max:r},c=>{n(c.value)})})}simpleUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const o=Math.random()*16|0;return(t==="x"?o:o&3|8).toString(16)})}formatDateTime(t,o=!1){if(typeof t=="string")t=new Date(t);else if(typeof t=="number")t=new Date(t);else if(!(t instanceof Date))return"";if(isNaN(t))return"";const r={year:t.getFullYear(),mounth:t.getMonth()+1,day:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds(),ms:t.getMilliseconds()},n=(c,i=2)=>(c+"").padStart(i,"0");let s=`${r.year}-${n(r.mounth)}-${n(r.day)} ${n(r.hour)}:${n(r.minute)}:${n(r.second)}`;return o&&(s+=`:${r.ms}`),s}formatDate(t){const o=this.formatDateTime(t);return o?o.split(" ")[0]:""}parseChineseNumber(t){const o={万亿:1e12,千亿:1e11,百亿:1e10,十亿:1e9,亿:1e8,千万:1e7,百万:1e6,万:1e4,千:1e3,百:100,十:10,k:1e3,K:1e3,m:1e6,M:1e6,b:1e9,B:1e9,t:1e12,T:1e12};let r="";for(const m in o)r?r+="|"+m:r+=m;const n=String(t).match(new RegExp(`^(\\d+.?\\d*)([${r})]*)`));if(!n)return 0;const s=parseFloat(n[1]),c=n[2].trim(),i=Object.keys(o).find(m=>c.startsWith(m)),l=i?o[i]:1;return c==="千万"?s*1e7:s*l}querySelector(t,o=[]){let r=null;for(const n of o){const s=n.match(/(.+):contains\(['"](.+)['"]\)/);if(s){const c=s[1],i=s[2];if(r=t.querySelector(c),r&&r.textContent.includes(i))break}else if(r=t.querySelector(n),r)break}return r}querySelectorAll(t,o=[]){for(const r of o){const n=r.match(/(.+):contains\(['"](.+)['"]\)/);if(n){const s=n[1],c=n[2],i=t.querySelectorAll(s);if(i&&i.length>0)return Array.from(i).filter(m=>m.textContent.includes(c))}else{const s=t.querySelectorAll(r);if(s.length>0)return Array.from(s)}}return[]}querySelectorWithText(t,o=[],r=""){let n=null;for(const s of o)if(n=t.querySelectorAll(s),n.length>0){for(const c of n)if(c.textContent.includes(r))return c}return null}querySelectorAllWithText(t,o=[],r=""){let n=null;for(const s of o)if(n=t.querySelectorAll(s),n.length>0)return Array.from(n).filter(c=>c.textContent.includes(r));return[]}}const u=new ce;function ue(e){v.runtime.onMessage.addListener((t,o,r)=>{if(t.action==="getData")return console.log("收到获取数据请求"),(async()=>{try{const n=await le(e);v.runtime.sendMessage({action:"dataReceived",data:n}),r({data:n})}catch(n){console.error("抓取数据时出错:",n),v.runtime.sendMessage({action:"dataError",error:n.message})}})(),r({action:"__default"}),!0})}async function le(e){const t=window.location.href,o=ae(t),r=ie(t);try{const n=await e(r,t);return console.log(`抓取到${r}数据:`,n),n.type=="unsupported"&&u.sendMessage("前页面不支持数据抓取"),await v.storage.local.set({[o]:{domain:r,type:n.type,data:n.data,timestamp:new Date().getTime(),fetchTime:n.fetchTime,url:t}}),n}catch(n){throw console.error("抓取过程中发生错误:",n),n}}/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function me(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const de=Object.assign,he=Object.prototype.hasOwnProperty,dt=(e,t)=>he.call(e,t),F=Array.isArray,et=e=>It(e)==="[object Map]",pe=e=>typeof e=="string",U=e=>typeof e=="symbol",ot=e=>e!==null&&typeof e=="object",we=Object.prototype.toString,It=e=>we.call(e),fe=e=>It(e).slice(8,-1),ht=e=>pe(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,nt=(e,t)=>!Object.is(e,t);/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ge,At=0,pt;function wt(){At++}function ft(){if(--At>0)return;let e;for(;pt;){let t=pt;for(pt=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(r){e||(e=r)}t=o}}if(e)throw e}let rt=!0;const Dt=[];function Ce(){Dt.push(rt),rt=!1}function be(){const e=Dt.pop();rt=e===void 0?!0:e}class ye{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){}trigger(t){this.version++,this.notify(t)}notify(t){wt();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{ft()}}}const gt=new WeakMap,$=Symbol(""),Ct=Symbol(""),K=Symbol("");function _(e,t,o){if(rt&&ge){let r=gt.get(e);r||gt.set(e,r=new Map);let n=r.get(o);n||(r.set(o,n=new ye),n.map=r,n.key=o),n.track()}}function R(e,t,o,r,n,s){const c=gt.get(e);if(!c)return;const i=l=>{l&&l.trigger()};if(wt(),t==="clear")c.forEach(i);else{const l=F(e),m=l&&ht(o);if(l&&o==="length"){const d=Number(r);c.forEach((h,w)=>{(w==="length"||w===K||!U(w)&&w>=d)&&i(h)})}else switch((o!==void 0||c.has(void 0))&&i(c.get(o)),m&&i(c.get(K)),t){case"add":l?m&&i(c.get("length")):(i(c.get($)),et(e)&&i(c.get(Ct)));break;case"delete":l||(i(c.get($)),et(e)&&i(c.get(Ct)));break;case"set":et(e)&&i(c.get($));break}}ft()}function W(e){const t=b(e);return t===e?t:(_(t,"iterate",K),q(e)?t:t.map(L))}function bt(e){return _(e=b(e),"iterate",K),e}const Te={__proto__:null,[Symbol.iterator](){return yt(this,Symbol.iterator,L)},concat(...e){return W(this).concat(...e.map(t=>F(t)?W(t):t))},entries(){return yt(this,"entries",e=>(e[1]=L(e[1]),e))},every(e,t){return D(this,"every",e,t,void 0,arguments)},filter(e,t){return D(this,"filter",e,t,o=>o.map(L),arguments)},find(e,t){return D(this,"find",e,t,L,arguments)},findIndex(e,t){return D(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return D(this,"findLast",e,t,L,arguments)},findLastIndex(e,t){return D(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return D(this,"forEach",e,t,void 0,arguments)},includes(...e){return Tt(this,"includes",e)},indexOf(...e){return Tt(this,"indexOf",e)},join(e){return W(this).join(e)},lastIndexOf(...e){return Tt(this,"lastIndexOf",e)},map(e,t){return D(this,"map",e,t,void 0,arguments)},pop(){return Y(this,"pop")},push(...e){return Y(this,"push",e)},reduce(e,...t){return Nt(this,"reduce",e,t)},reduceRight(e,...t){return Nt(this,"reduceRight",e,t)},shift(){return Y(this,"shift")},some(e,t){return D(this,"some",e,t,void 0,arguments)},splice(...e){return Y(this,"splice",e)},toReversed(){return W(this).toReversed()},toSorted(e){return W(this).toSorted(e)},toSpliced(...e){return W(this).toSpliced(...e)},unshift(...e){return Y(this,"unshift",e)},values(){return yt(this,"values",L)}};function yt(e,t,o){const r=bt(e),n=r[t]();return r!==e&&!q(e)&&(n._next=n.next,n.next=()=>{const s=n._next();return s.value&&(s.value=o(s.value)),s}),n}const ve=Array.prototype;function D(e,t,o,r,n,s){const c=bt(e),i=c!==e&&!q(e),l=c[t];if(l!==ve[t]){const h=l.apply(e,s);return i?L(h):h}let m=o;c!==e&&(i?m=function(h,w){return o.call(this,L(h),w,e)}:o.length>2&&(m=function(h,w){return o.call(this,h,w,e)}));const d=l.call(c,m,r);return i&&n?n(d):d}function Nt(e,t,o,r){const n=bt(e);let s=o;return n!==e&&(q(e)?o.length>3&&(s=function(c,i,l){return o.call(this,c,i,l,e)}):s=function(c,i,l){return o.call(this,c,L(i),l,e)}),n[t](s,...r)}function Tt(e,t,o){const r=b(e);_(r,"iterate",K);const n=r[t](...o);return(n===-1||n===!1)&&Me(o[0])?(o[0]=b(o[0]),r[t](...o)):n}function Y(e,t,o=[]){Ce(),wt();const r=b(e)[t].apply(e,o);return ft(),be(),r}const xe=me("__proto__,__v_isRef,__isVue"),Rt=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(U));function Se(e){U(e)||(e=String(e));const t=b(this);return _(t,"has",e),t.hasOwnProperty(e)}class Ot{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,r){if(o==="__v_skip")return t.__v_skip;const n=this._isReadonly,s=this._isShallow;if(o==="__v_isReactive")return!n;if(o==="__v_isReadonly")return n;if(o==="__v_isShallow")return s;if(o==="__v_raw")return r===(n?s?Oe:Mt:s?Re:qt).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(r)?t:void 0;const c=F(t);if(!n){let l;if(c&&(l=Te[o]))return l;if(o==="hasOwnProperty")return Se}const i=Reflect.get(t,o,J(t)?t:r);return(U(o)?Rt.has(o):xe(o))||(n||_(t,"get",o),s)?i:J(i)?c&&ht(o)?i:i.value:ot(i)?n?Vt(i):xt(i):i}}class Ee extends Ot{constructor(t=!1){super(!1,t)}set(t,o,r,n){let s=t[o];if(!this._isShallow){const l=G(s);if(!q(r)&&!G(r)&&(s=b(s),r=b(r)),!F(t)&&J(s)&&!J(r))return l?!1:(s.value=r,!0)}const c=F(t)&&ht(o)?Number(o)<t.length:dt(t,o),i=Reflect.set(t,o,r,J(t)?t:n);return t===b(n)&&(c?nt(r,s)&&R(t,"set",o,r):R(t,"add",o,r)),i}deleteProperty(t,o){const r=dt(t,o);t[o];const n=Reflect.deleteProperty(t,o);return n&&r&&R(t,"delete",o,void 0),n}has(t,o){const r=Reflect.has(t,o);return(!U(o)||!Rt.has(o))&&_(t,"has",o),r}ownKeys(t){return _(t,"iterate",F(t)?"length":$),Reflect.ownKeys(t)}}class _e extends Ot{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const Le=new Ee,Pe=new _e,vt=e=>e,st=e=>Reflect.getPrototypeOf(e);function Ie(e,t,o){return function(...r){const n=this.__v_raw,s=b(n),c=et(s),i=e==="entries"||e===Symbol.iterator&&c,l=e==="keys"&&c,m=n[e](...r),d=o?vt:t?St:L;return!t&&_(s,"iterate",l?Ct:$),{next(){const{value:h,done:w}=m.next();return w?{value:h,done:w}:{value:i?[d(h[0]),d(h[1])]:d(h),done:w}},[Symbol.iterator](){return this}}}}function it(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Ae(e,t){const o={get(n){const s=this.__v_raw,c=b(s),i=b(n);e||(nt(n,i)&&_(c,"get",n),_(c,"get",i));const{has:l}=st(c),m=t?vt:e?St:L;if(l.call(c,n))return m(s.get(n));if(l.call(c,i))return m(s.get(i));s!==c&&s.get(n)},get size(){const n=this.__v_raw;return!e&&_(b(n),"iterate",$),Reflect.get(n,"size",n)},has(n){const s=this.__v_raw,c=b(s),i=b(n);return e||(nt(n,i)&&_(c,"has",n),_(c,"has",i)),n===i?s.has(n):s.has(n)||s.has(i)},forEach(n,s){const c=this,i=c.__v_raw,l=b(i),m=t?vt:e?St:L;return!e&&_(l,"iterate",$),i.forEach((d,h)=>n.call(s,m(d),m(h),c))}};return de(o,e?{add:it("add"),set:it("set"),delete:it("delete"),clear:it("clear")}:{add(n){!t&&!q(n)&&!G(n)&&(n=b(n));const s=b(this);return st(s).has.call(s,n)||(s.add(n),R(s,"add",n,n)),this},set(n,s){!t&&!q(s)&&!G(s)&&(s=b(s));const c=b(this),{has:i,get:l}=st(c);let m=i.call(c,n);m||(n=b(n),m=i.call(c,n));const d=l.call(c,n);return c.set(n,s),m?nt(s,d)&&R(c,"set",n,s):R(c,"add",n,s),this},delete(n){const s=b(this),{has:c,get:i}=st(s);let l=c.call(s,n);l||(n=b(n),l=c.call(s,n)),i&&i.call(s,n);const m=s.delete(n);return l&&R(s,"delete",n,void 0),m},clear(){const n=b(this),s=n.size!==0,c=n.clear();return s&&R(n,"clear",void 0,void 0),c}}),["keys","values","entries",Symbol.iterator].forEach(n=>{o[n]=Ie(n,e,t)}),o}function $t(e,t){const o=Ae(e,t);return(r,n,s)=>n==="__v_isReactive"?!e:n==="__v_isReadonly"?e:n==="__v_raw"?r:Reflect.get(dt(o,n)&&n in r?o:r,n,s)}const De={get:$t(!1,!1)},Ne={get:$t(!0,!1)},qt=new WeakMap,Re=new WeakMap,Mt=new WeakMap,Oe=new WeakMap;function $e(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function qe(e){return e.__v_skip||!Object.isExtensible(e)?0:$e(fe(e))}function xt(e){return G(e)?e:kt(e,!1,Le,De,qt)}function Vt(e){return kt(e,!0,Pe,Ne,Mt)}function kt(e,t,o,r,n){if(!ot(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const s=qe(e);if(s===0)return e;const c=n.get(e);if(c)return c;const i=new Proxy(e,s===2?r:o);return n.set(e,i),i}function G(e){return!!(e&&e.__v_isReadonly)}function q(e){return!!(e&&e.__v_isShallow)}function Me(e){return e?!!e.__v_raw:!1}function b(e){const t=e&&e.__v_raw;return t?b(t):e}const L=e=>ot(e)?xt(e):e,St=e=>ot(e)?Vt(e):e;function J(e){return e?e.__v_isRef===!0:!1}/*!
 * pinia v3.0.3
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */var Bt;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Bt||(Bt={}));const Et=()=>({feishu:{label:"飞书多维表格设置",feishu_base_url:{value:"",max:200,defalutVaue:"",label:"多维表格URL",placeholder:"多维表格URL 例如: https://mideqnf1p7d.feishu.cn/base/TAAsbKNniaMaodss84tcEQSun3f?table=tbllpvh8BykaNQBM&view=vewvd05oOX"}},dignding:{label:"钉钉AI表格设置",appKey:{value:"",max:100,defalutVaue:"",label:"appKey",placeholder:"appKey"},appSecret:{value:"",max:100,defalutVaue:"",label:"appSecret",placeholder:"appSecret"},baseId:{value:"",max:100,defalutVaue:"",label:"baseId",placeholder:"baseId 文档Id"},phone:{value:"",max:100,defalutVaue:"",label:"手机号",placeholder:"钉钉用户绑定的手机号码"}},douyin:{label:"抖音设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxUserVideoCount:{value:100,max:200,defalutVaue:100,label:"最大用户视频数量",placeholder:"最大用户视频数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},xiaohongshu:{label:"小红书设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxUserNoteCount:{value:100,max:200,defalutVaue:100,label:"最大用户笔记数量",placeholder:"最大用户笔记数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},jd:{label:"京东设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},taobao:{label:"淘宝设置",maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},sycm_taobao:{label:"生意参谋设置",maxOverviewDataCount:{value:100,max:200,defalutVaue:100,label:"最大客户概况数量",placeholder:"最大客户概况数量"},maxCustomerTripDataCount:{value:100,max:200,defalutVaue:100,label:"最大客户旅程数量",placeholder:"最大客户旅程数量"},maxCustomerTripGoodsDataCount:{value:100,max:200,defalutVaue:100,label:"最大客户旅程商品数量",placeholder:"最大客户旅程商品数量"}},one_alimama:{label:"阿里妈妈万象台设置",maxGoodsListCount:{value:100,max:200,defalutVaue:100,label:"最大商品数量",placeholder:"最大商品数量"}},tiktok:{label:"tiktok设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxUserVideoCount:{value:100,max:200,defalutVaue:100,label:"最大用户视频数量",placeholder:"最大用户视频数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},youtube:{label:"tiktok设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxUserVideoCount:{value:100,max:200,defalutVaue:100,label:"最大用户视频数量",placeholder:"最大用户视频数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}}});let Ve=Et();xt(Ve);const Ft="__setting",Wt=async()=>{var t=(await v.storage.local.get([Ft]))[Ft];if(t){const r=t;var o=Et();return Object.keys(o).forEach(n=>{n in r||(r[n]=o[n])}),r}else return Et()};class at{constructor(){a(this,"count");a(this,"fenSiPercent");a(this,"vipPercent");a(this,"payCount");a(this,"unPayCount");a(this,"payRate");a(this,"payPercent");a(this,"avgPrice");a(this,"recallRate");this.count=0,this.fenSiPercent=0,this.vipPercent=0,this.payCount=0,this.unPayCount=0,this.payRate=0,this.payPercent=0,this.avgPrice=0,this.recallRate=0}}class ke{constructor(){a(this,"timeFrom");a(this,"timeTo");a(this,"newCustomer");a(this,"unBuyCustomerData");a(this,"buyCustomerData");this.timeFrom="",this.timeTo="",this.newCustomer=new at,this.unBuyCustomerData=new at,this.buyCustomerData=new at}}class P{constructor(){a(this,"count",0);a(this,"newCustomerCount",0);a(this,"unPayCustomerCount",0);a(this,"payCustomerCount",0);this.count=0,this.newCustomerCount=0,this.unPayCustomerCount=0,this.payCustomerCount=0}}class Be{constructor(){a(this,"timeFrom","");a(this,"timeTo","");a(this,"advertisementGuides",new P);a(this,"validContentsNumber",new P);a(this,"onlineNewProductsNumber",new P);a(this,"externalRefluxNumber",new P);a(this,"onlineRightNumber",new P);a(this,"storeBroadcastDuration",new P);this.timeFrom="",this.timeTo="",this.advertisementGuides=new P,this.validContentsNumber=new P,this.onlineNewProductsNumber=new P,this.externalRefluxNumber=new P,this.onlineRightNumber=new P,this.storeBroadcastDuration=new P}}class Fe{constructor(){a(this,"storeCustomerList");a(this,"storePutIntoOperationList");this.storeCustomerList=[],this.storePutIntoOperationList=[]}}async function We(){console.log("scraping SYCM customer overview data");const t=(await Wt()).sycm_taobao.maxOverviewDataCount.value,o=new Fe;return await mt(),o.storeCustomerList=await He(t),o.storePutIntoOperationList=await je(t),o}async function He(e){const t=[],o=document.querySelector("div[oui-card-uid^='客户-客户概况|店铺客户']");if(!o)throw u.sendMessage("未找到客户概况-店铺客户数据"),new Error("未找到客户概况-店铺客户数据");const r=o.querySelector("div.pro-layout-card-body"),n=o.getElementsByClassName("ant-btn oui-canary-btn ant-btn-sm"),s=n[n.length-3],c=n[n.length-2],i=o.querySelector(".oui-date-picker-current-date");if(!r)throw u.sendMessage("未找到 div.pro-layout-card-body"),new Error("未找到 div.pro-layout-card-body");if(!i)throw u.sendMessage("未找到 .oui-date-picker-current-date"),new Error("未找到 .oui-date-picker-current-date");const l=(h,w)=>{const f="___abcxxxabc___",T=`${h}_${w}`,E=document.querySelector(`body>div[style^='position: absolute; top: 0px; left: 0px; width: 100%;'] div.ant-tooltip-content div[${f}='${T}']`);if(E)return E;const x=document.querySelectorAll("body>div[style^='position: absolute; top: 0px; left: 0px; width: 100%;'] div.ant-tooltip-content div:nth-child(2)"),A=x[x.length-1];return A.setAttribute(f,T),A},m=async h=>{const w=new at,f=o.querySelector(`div[id='${h}']`);if(!f)throw u.sendMessage(`未找到div[id='${h}']`),new Error(`未找到div[id='${h}']`);const T=f.querySelector("div[data-onetrace-index-id] span");w.count=u.getElementTextToNumber(T);const[E,x]=f.querySelectorAll("div.colum-1 div.pro-layout-row-col-container div[pagestate]");u.elementHover(E,!0),await u.sleep(100);const A=l(h,"fenSiPercentEle").textContent;u.elementHover(E,!1),w.fenSiPercent=+A.split(" ")[1].replace("%",""),u.elementHover(x,!0),await u.sleep(100);const H=l(h,"vipPercent").textContent;u.elementHover(x,!1),w.vipPercent=+H.split(" ")[1].replace("%","");const[p,y]=f.querySelectorAll("div.bottom div.pro-layout-row a>span >span:nth-child(2)");w.payCount=u.getElementTextToNumber(p),w.unPayCount=u.getElementTextToNumber(y);const[g,S,j]=f.querySelectorAll("div.bottom div.index-group-level-2 span.numbervalue");w.payRate=u.getElementTextToNumber(g),w.payPercent=u.getElementTextToNumber(S),w.avgPrice=u.getElementTextToNumber(j);const V=f.querySelectorAll("span");let O=null;for(let z=0;z<V.length;z++){const Z=V[z];if(Z.textContent&&Z.textContent.includes("召回率")){O=Z.parentElement;break}}if(!O)throw u.sendMessage("未找到召回率"),new Error("未找到召回率");const Q=O.querySelectorAll("span");return w.recallRate=u.getElementTextToNumber(Q[Q.length-1]),w},d=async()=>{const h=i.textContent.split(" "),w=h[1],f=h[3];console.log("startTime",w,"endTime",f),u.sendMessage(`正在抓取客户概况-店铺客户-第${t.length+1}条,最多${e}条,"${w}-${f}`);const T=new ke;T.timeFrom=w,T.timeTo=f;const E=await m("0-0"),x=await m("0-2"),A=await m("0-4");T.newCustomer=E,T.unBuyCustomerData=x,T.buyCustomerData=A,t.push(T)};for(await u.waitForElementTextChange(()=>{s.click()},r,5e3);t.length<e&&(await u.sleep(200),await d(),!c.hasAttribute("disabled"));)await u.waitForElementTextChange(()=>{c.click()},r,5e3);return u.sendMessage(`完成 抓取客户概况数据，总计:${t.length}条`),t}async function je(e){const t=[],o=document.querySelector("div[oui-card-uid^='客户-客户概况|店铺运营投入']");if(!o)throw u.sendMessage("未找到 div[oui-card-uid^='客户-客户概况|店铺运营投入']"),new Error("未找到 div[oui-card-uid^='客户-客户概况|店铺运营投入']");const r=o.querySelector("div.pro-layout-card-body"),n=o.getElementsByClassName("ant-btn oui-canary-btn ant-btn-sm"),s=n[n.length-3],c=n[n.length-2],i=o.querySelector(".oui-date-picker-current-date");if(!r)throw u.sendMessage("未找到 div.pro-layout-card-body"),new Error("未找到 div.pro-layout-card-body");if(!i)throw u.sendMessage("未找到 .oui-date-picker-current-date"),new Error("未找到 .oui-date-picker-current-date");u.scrollToElement(o);const l=async d=>{const h=new P,w=o.querySelector(`div[id='${d}']`);if(!w)throw u.sendMessage(`未找到 div[id='${d}']`),new Error(`未找到 div[id='${d}']`);const f=w.querySelector("div.operation-card-item>div:nth-child(2) ");h.count=u.getElementTextToNumber(f);const[T,E,x]=w.querySelectorAll("div.operation-card-item>div:nth-child(3) span.numbervalue");return h.newCustomerCount=u.getElementTextToNumber(T),h.unPayCustomerCount=u.getElementTextToNumber(E),h.payCustomerCount=u.getElementTextToNumber(x),h},m=async()=>{const d=i.textContent.split(" "),h=d[1],w=d[3];console.log("startTime",h,"endTime",w),u.sendMessage(`正在抓取客户概况-店铺运营投入-第${t.length+1}条,最多${e}条,"${h}-${w}`);const f=new Be;f.timeFrom=h,f.timeTo=w;const T=await l("0"),E=await l("1"),x=await l("2"),A=await l("3"),H=await l("4"),p=await l("5");f.advertisementGuides=T,f.validContentsNumber=E,f.onlineNewProductsNumber=x,f.externalRefluxNumber=A,f.onlineRightNumber=H,f.storeBroadcastDuration=p,t.push(f)};for(await u.waitForElementTextChange(()=>{s.click()},r,5e3);t.length<e&&(await u.sleep(200),await m(),!c.hasAttribute("disabled"));)await u.waitForElementTextChange(()=>{c.click()},r,5e3);return u.sendMessage(`完成 抓取客户概况店-铺运营投入,总计:${t.length}条`),t}class M{constructor(){a(this,"key","");a(this,"value","");a(this,"percent",0);this.key="",this.value="",this.percent=0}}class Ht{constructor(){a(this,"sexList");a(this,"ageList");a(this,"areaList");a(this,"educationalBackgroundList");a(this,"interestsList");a(this,"consumerHierarchyList");this.sexList=new M,this.ageList=new M,this.areaList=new M,this.educationalBackgroundList=new M,this.interestsList=new M,this.consumerHierarchyList=new M}}class I{constructor(){a(this,"comparedToLastWeekPercent");a(this,"sameIndustryExcellent");this.comparedToLastWeekPercent=0,this.sameIndustryExcellent=0}}class C extends I{constructor(){super();a(this,"count");this.count=0}}class jt extends I{constructor(){super();a(this,"unitPrice");this.unitPrice=0}}class Ut extends I{constructor(){super();a(this,"JointRate");this.JointRate=0}}class Kt extends I{constructor(){super();a(this,"payAmount");this.payAmount=0}}class Yt extends I{constructor(){super();a(this,"customerCount",0);a(this,"viewProductCustomerCount");a(this,"avgViewProductCustomerCount");a(this,"viewStoreCustomerCount");a(this,"viewliveBroadcastCustomerCount");a(this,"viewShortVideoCustomerCount");a(this,"viewImageTextCustomerCount");this.customerCount=0,this.viewProductCustomerCount=new C,this.avgViewProductCustomerCount=new C,this.viewStoreCustomerCount=new C,this.viewliveBroadcastCustomerCount=new C,this.viewShortVideoCustomerCount=new C,this.viewImageTextCustomerCount=new C}}class Gt extends I{constructor(){super();a(this,"customerCount");a(this,"percent");a(this,"shortVideoInteractionCustomerCount");a(this,"ImageTextInteractionCustomerCount");a(this,"liveBroadcastInteractionCustomerCount");this.customerCount=0,this.percent=0,this.shortVideoInteractionCustomerCount=new C,this.ImageTextInteractionCustomerCount=new C,this.liveBroadcastInteractionCustomerCount=new C}}class Jt extends I{constructor(){super();a(this,"customerCount");a(this,"percent");a(this,"collectingProductCustomerCount");a(this,"addPurchaseProductCustomerCount");a(this,"newFensiCustomerCount");a(this,"JoinAssociationCustomerCount");a(this,"claimRightsCustomerCount");a(this,"consultingCustomerCount");this.customerCount=0,this.percent=0,this.collectingProductCustomerCount=new C,this.addPurchaseProductCustomerCount=new C,this.newFensiCustomerCount=new C,this.JoinAssociationCustomerCount=new C,this.claimRightsCustomerCount=new C,this.consultingCustomerCount=new C}}class Xt extends I{constructor(){super();a(this,"buyersCount");a(this,"percent");a(this,"payAmount");a(this,"paySubOrderCount");a(this,"customerUnitPrice");a(this,"JointRate");a(this,"avgRepurchaseCycle");this.buyersCount=0,this.percent=0,this.payAmount=new C,this.paySubOrderCount=new C,this.customerUnitPrice=new jt,this.JointRate=new Ut,this.avgRepurchaseCycle=new C}}class Qt{constructor(){a(this,"view");a(this,"interaction");a(this,"intention");a(this,"pay");this.view=new Yt,this.interaction=new Gt,this.intention=new Jt,this.pay=new Xt}}class zt extends I{constructor(){super();a(this,"buyersCount");a(this,"viewProductCustomerCount");a(this,"collectingProductCustomerCount");a(this,"addPurchaseProductCustomerCount");a(this,"placeOrderCustomerCount");a(this,"payAmount");a(this,"productList");this.buyersCount=0,this.viewProductCustomerCount=new C,this.collectingProductCustomerCount=new C,this.addPurchaseProductCustomerCount=new C,this.placeOrderCustomerCount=new C,this.payAmount=new Kt,this.productList=[]}}class Zt extends I{constructor(){super();a(this,"viewStoreCustomerCount",0);a(this,"newFensiCustomerCount");a(this,"JoinAssociationCustomerCount");a(this,"consultingCustomerCount");a(this,"addPurchaseProductCustomerCount");this.viewStoreCustomerCount=0,this.newFensiCustomerCount=new C,this.JoinAssociationCustomerCount=new C,this.consultingCustomerCount=new C,this.addPurchaseProductCustomerCount=new C}}class te extends I{constructor(){super();a(this,"viewLiveBroadcastCustomerCount");a(this,"avgViewTime");a(this,"liveBroadcastInteractionCustomerCount");this.viewLiveBroadcastCustomerCount=0,this.avgViewTime=new C,this.liveBroadcastInteractionCustomerCount=new C}}class ee extends I{constructor(){super();a(this,"viewContentCustomerCount");a(this,"shortVideoInteractionCustomerCount");a(this,"ImageTextInteractionCustomerCount");this.viewContentCustomerCount=0,this.shortVideoInteractionCustomerCount=new C,this.ImageTextInteractionCustomerCount=new C}}class oe extends I{constructor(){super();a(this,"claimRightsCustomerCount");a(this,"writeOff");this.claimRightsCustomerCount=0,this.writeOff=new C}}class ne{constructor(){a(this,"protuctStatistics");a(this,"storeStatistics");a(this,"liveBroadcastStatistics");a(this,"contentStatistics");a(this,"rightsStatistics");this.protuctStatistics=new zt,this.storeStatistics=new Zt,this.liveBroadcastStatistics=new te,this.contentStatistics=new ee,this.rightsStatistics=new oe}}class Ue{constructor(){a(this,"productId");a(this,"productName");a(this,"productUrl");a(this,"productImageUrl");a(this,"viewCustomerCount");a(this,"collectingCustomerCount");a(this,"addPurchaseCustomerCount");a(this,"orderCustomerCount");a(this,"buyersCustomerCount");a(this,"paymentAmount");this.productId="",this.productName="",this.productUrl="",this.productImageUrl="",this.viewCustomerCount=0,this.collectingCustomerCount=0,this.addPurchaseCustomerCount=0,this.orderCustomerCount=0,this.buyersCustomerCount=0,this.paymentAmount=0}}class Ke{constructor(){a(this,"timeFrom");a(this,"timeTo");a(this,"customerPortrait");a(this,"customerActionStatistics");a(this,"operationTargetStatistics");this.timeFrom="",this.timeTo="",this.customerPortrait=new Ht,this.customerActionStatistics=new Qt,this.operationTargetStatistics=new ne}}class Ye{constructor(){a(this,"newCustomerDataList");a(this,"unBuyCustomerDataList");a(this,"buyCustomerDataList");this.newCustomerDataList=[],this.unBuyCustomerDataList=[],this.buyCustomerDataList=[]}}async function Ge(){console.log("scraping SYCM customer trip data");const e=await Wt(),t=e.sycm_taobao.maxCustomerTripDataCount.value,o=e.sycm_taobao.maxCustomerTripGoodsDataCount.value,r=new Ye,n=new Je(t,o);return r.newCustomerDataList=await n.getCustomerTripDataListByType(1),r.unBuyCustomerDataList=await n.getCustomerTripDataListByType(2),r.buyCustomerDataList=await n.getCustomerTripDataListByType(3),r}class Je{constructor(t,o){a(this,"totalDataCount");a(this,"productListDataCount");a(this,"topRoot");a(this,"btns");a(this,"btnDay");a(this,"btnWeek");a(this,"btnPrew");a(this,"divTime");a(this,"rangeIndex",1);a(this,"rangeText","");a(this,"dataList",[]);a(this,"root_CustomerPortrait_selector","");a(this,"root_CustomerAction_selector","");a(this,"root_OperationTarget_selector","");a(this,"root_CustomerPortrait");a(this,"root_CustomerAction");a(this,"root_OperationTarget");a(this,"targetList",[]);a(this,"startTime","");a(this,"endTime","");a(this,"customerRange");a(this,"processSubList",async(t,o)=>{const r=new C;try{await tt(`${o} .common-scroll-container >div:nth-child(${t}) span.value`,2e3)}catch{return r}const n=document.querySelectorAll(`${o} .common-scroll-container >div:nth-child(${t}) span.value`);return console.log(`subValueEles length :${n.length}`),r.count=u.getElementTextToNumber(n[0]),r.comparedToLastWeekPercent=u.getElementTextToNumber(n[1]),r.sameIndustryExcellent=u.getElementTextToNumber(n[2]),r});if(this.totalDataCount=t,this.productListDataCount=o,this.topRoot=document.querySelector('div[oui-card-uid="客户旅程|客户旅程-头部"]'),!this.topRoot)throw u.sendMessage('未找到 div[oui-card-uid="客户旅程|客户旅程-头部"]'),new Error('未找到 div[oui-card-uid="客户旅程|客户旅程-头部"]');this.btns=this.topRoot.querySelectorAll(".oui-date-picker-particle-button .ant-btn"),this.btnDay=this.btns[0],this.btnWeek=this.btns[1],this.btnPrew=this.btns[3],this.divTime=this.topRoot.querySelector(".oui-date-picker-current-date")}async getCustomerTripDataListByType(t){if(await mt(),this.dataList=[],this.rangeIndex=t,this.rangeText=["客户新访","未购客户回访","已购客户回访"][t-1],this.customerRange=this.topRoot.querySelector(`div.pro-layout-card-body__panel>div:nth-child(1) 
          div.pro-layout-col:nth-child(2) 
          div.ant-radio-group label.ant-radio-wrapper:nth-child(${t}) input[type="radio"]`),!this.customerRange)throw u.sendMessage(`未找到 ${this.rangeText} 的内容`),new Error(`未找到 ${this.rangeText} 的内容`);this.customerRange.click();try{await tt('div[oui-card-uid="客户旅程|客户画像-标签块"]',1e3)}catch(o){return u.sendMessage(`抓取客户旅程-${this.rangeText}-数据失败,${o}`),console.log(`抓取客户旅程-${this.rangeText}-数据失败`,o),this.dataList}await u.sleep(200),this.root_CustomerPortrait_selector='div[oui-card-uid="客户旅程|客户画像-标签块"]',this.root_CustomerAction_selector='div[oui-card-uid="客户旅程|客户动作统计"]',this.root_OperationTarget_selector='div[oui-card-uid="客户旅程|运营对象统计"]',this.root_CustomerPortrait=()=>document.querySelector(this.root_CustomerPortrait_selector),this.root_CustomerAction=()=>document.querySelector(this.root_CustomerAction_selector),this.root_OperationTarget=()=>document.querySelector(this.root_OperationTarget_selector),this.targetList=[this.root_CustomerPortrait(),this.root_CustomerAction(),this.root_OperationTarget()];try{await tt('div[oui-card-uid="客户旅程|运营对象统计"] .repeater-item',1e3)}catch(o){u.sendMessage(`抓取客户旅程-${this.rangeText}-数据失败,${o}`),await mt()}for(await u.waitForElementListTextChange(async()=>{this.btnDay.click()},this.targetList,5e3),await u.waitForElementListTextChange(async()=>{this.btnWeek.click()},this.targetList,5e3);this.dataList.length<this.totalDataCount;){await u.sleep(200);const o=await this.process();if(this.dataList.push(o),this.dataList.length>=this.totalDataCount)break;if(!this.btnPrew.hasAttribute("disabled"))await u.waitForElementListTextChange(()=>{this.btnPrew.click()},this.targetList,5e3);else break}return u.sendMessage(`抓取客户旅程-${this.rangeText}-数据成功，共${this.dataList.length}条`),this.dataList}async process(){const t=new Ke,o=this.divTime.textContent.split(" "),r=o[1],n=o[3];return this.startTime=r,this.endTime=n,console.log(`正在抓取客户旅程-${this.rangeText}-数据 ：`,"startTime",r,"endTime",n),u.sendMessage(`正在抓取客户旅程-${this.rangeText}-数据 ：`+r+"至"+n),t.timeFrom=r,t.timeTo=n,t.customerPortrait=await this.processCustomerPortrait(),t.customerActionStatistics=await this.processCustomerActionStatistics(),t.operationTargetStatistics=await this.processOperationTargetStatistics(),t}async processCustomerPortrait(){const t=new Ht;u.scrollToElement(this.root_CustomerPortrait()),await u.sleep(100);const o=async r=>{const n=new M;if(this.root_CustomerPortrait().querySelector('img[alt^="当前人群数量较小"'))return u.sendMessage("当前人群数量较小,暂不支持人群透视分析"),n;const c=this.root_CustomerPortrait().querySelector(`.repeater-item:nth-child(${r})>div>.pro-layout-row-col-container`);return n.percent=+u.setElementAnimation(c.querySelector(".pro-layout-col:first-child>.low-grid-block>div:last-child")).textContent.replace("%",""),n.key=u.setElementAnimation(c.querySelector(".pro-layout-col:last-child>.low-grid-block>div:first-child")).textContent,n.value=u.setElementAnimation(c.querySelector(".pro-layout-col:last-child>.low-grid-block>div:last-child")).textContent,n};return u.sendMessage(`正在抓取客户旅程-${this.rangeText}-客户画像-第${this.dataList.length+1}条,最多${this.totalDataCount}条,${this.startTime}-${this.endTime}`),t.sexList=await o(1),t.ageList=await o(2),t.areaList=await o(3),t.educationalBackgroundList=await o(4),t.interestsList=await o(5),t.consumerHierarchyList=await o(6),t}async processCustomerActionStatistics(){const t=new Qt;u.scrollToElement(this.root_CustomerAction());const o=async()=>{const c=this.root_CustomerAction_selector,i=this.root_CustomerAction().querySelectorAll(".low-repeater.repeater-wrapper >div:nth-child(1) span.value"),l=this.root_CustomerAction().querySelector(".common-scroll-container");u.waitForElementTextChange(async()=>{i[0].click()},l,1e3),await u.sleep(100);const m=new Yt;return m.customerCount=u.getElementTextToNumber(i[0]),m.comparedToLastWeekPercent=u.getElementTextToNumber(i[1]),m.sameIndustryExcellent=u.getElementTextToNumber(i[2]),m.viewProductCustomerCount=await this.processSubList(1,c),m.avgViewProductCustomerCount=await this.processSubList(2,c),m.viewStoreCustomerCount=await this.processSubList(3,c),m.viewliveBroadcastCustomerCount=await this.processSubList(4,c),m.viewShortVideoCustomerCount=await this.processSubList(5,c),m.viewImageTextCustomerCount=await this.processSubList(6,c),m},r=async()=>{const c=this.root_CustomerAction_selector,i=this.root_CustomerAction().querySelectorAll(".low-repeater.repeater-wrapper >div:nth-child(2) span.value"),l=this.root_CustomerAction().querySelector(".common-scroll-container");u.waitForElementTextChange(async()=>{console.log("准备点击互动：",i[0]),i[0].click()},l,1e3),await u.sleep(100);const m=new Gt,d=this.root_CustomerAction().querySelector(".low-repeater.repeater-wrapper >div:nth-child(2) div.slot-line");return m.percent=u.getElementTextToNumber(d),m.customerCount=u.getElementTextToNumber(i[0]),m.comparedToLastWeekPercent=u.getElementTextToNumber(i[1]),m.sameIndustryExcellent=u.getElementTextToNumber(i[2]),m.shortVideoInteractionCustomerCount=await this.processSubList(1,c),m.ImageTextInteractionCustomerCount=await this.processSubList(2,c),m.liveBroadcastInteractionCustomerCount=await this.processSubList(3,c),m},n=async()=>{const c=this.root_CustomerAction_selector,i=this.root_CustomerAction().querySelectorAll(".low-repeater.repeater-wrapper >div:nth-child(3) span.value"),l=this.root_CustomerAction().querySelector(".common-scroll-container");u.waitForElementTextChange(async()=>{console.log("准备点击意向按钮：",i[0]),i[0].click()},l,1e3),await u.sleep(100);const m=new Jt,d=this.root_CustomerAction().querySelector(".low-repeater.repeater-wrapper >div:nth-child(3) div.slot-line");return m.percent=u.getElementTextToNumber(d),m.customerCount=u.getElementTextToNumber(i[0]),m.comparedToLastWeekPercent=u.getElementTextToNumber(i[1]),m.sameIndustryExcellent=u.getElementTextToNumber(i[2]),m.collectingProductCustomerCount=await this.processSubList(1,c),m.addPurchaseProductCustomerCount=await this.processSubList(2,c),m.newFensiCustomerCount=await this.processSubList(3,c),m.JoinAssociationCustomerCount=await this.processSubList(4,c),m.claimRightsCustomerCount=await this.processSubList(5,c),m.consultingCustomerCount=await this.processSubList(6,c),m},s=async()=>{const c=this.root_CustomerAction_selector,i=this.root_CustomerAction().querySelectorAll(".low-repeater.repeater-wrapper >div:nth-child(4) span.value"),l=this.root_CustomerAction().querySelector(".common-scroll-container");u.waitForElementTextChange(async()=>{console.log("准备点击支付按钮：",i[0]),i[0].click()},l,1e3),await u.sleep(100);const m=new Xt,d=this.root_CustomerAction().querySelector(".low-repeater.repeater-wrapper >div:nth-child(4) div.slot-line");m.percent=u.getElementTextToNumber(d),m.buyersCount=u.getElementTextToNumber(i[0]),m.comparedToLastWeekPercent=u.getElementTextToNumber(i[1]),m.sameIndustryExcellent=u.getElementTextToNumber(i[2]),m.payAmount=await this.processSubList(1,c),m.paySubOrderCount=await this.processSubList(2,c);let h=await this.processSubList(3,c);const w=new jt;w.unitPrice=h.count,w.comparedToLastWeekPercent=h.comparedToLastWeekPercent,w.sameIndustryExcellent=h.sameIndustryExcellent,m.customerUnitPrice=w,h=await this.processSubList(4,c);const f=new Ut;return f.JointRate=h.count,f.comparedToLastWeekPercent=h.comparedToLastWeekPercent,f.sameIndustryExcellent=h.sameIndustryExcellent,m.JointRate=f,m.avgRepurchaseCycle=await this.processSubList(5,c),m};return u.sendMessage(`正在抓取客户旅程-${this.rangeText}-客户动作-第${this.dataList.length+1}条,最多${this.totalDataCount}条,${this.startTime}-${this.endTime}`),t.view=await o(),t.interaction=await r(),t.intention=await n(),t.pay=await s(),t}async processOperationTargetStatistics(){const t=new ne;u.scrollToElement(this.root_OperationTarget());const o=async()=>{const i=this.root_OperationTarget_selector,l=this.root_OperationTarget().querySelectorAll(".low-repeater.repeater-wrapper >div:nth-child(1) span.value"),m=this.root_CustomerAction().querySelector(".common-scroll-container");u.waitForElementTextChange(async()=>{l[0].click()},m,1e3),await u.sleep(100);const d=new zt;d.buyersCount=u.getElementTextToNumber(l[0]),d.comparedToLastWeekPercent=+u.getElementTextToNumber(l[1]),d.sameIndustryExcellent=u.getElementTextToNumber(l[2]),d.viewProductCustomerCount=await this.processSubList(1,i),d.collectingProductCustomerCount=await this.processSubList(2,i),d.addPurchaseProductCustomerCount=await this.processSubList(3,i),d.placeOrderCustomerCount=await this.processSubList(4,i);let h=await this.processSubList(5,i);const w=new Kt;return w.payAmount=h.count,w.comparedToLastWeekPercent=h.comparedToLastWeekPercent,w.sameIndustryExcellent=h.sameIndustryExcellent,d.payAmount=w,d.productList=await this.processProductList(),d},r=async()=>{const i=this.root_OperationTarget_selector,l=this.root_OperationTarget().querySelectorAll(".low-repeater.repeater-wrapper >div:nth-child(2) span.value"),m=this.root_CustomerAction().querySelector(".common-scroll-container");u.waitForElementTextChange(async()=>{l[0].click()},m,1e3),await u.sleep(100);const d=new Zt;return d.viewStoreCustomerCount=+u.getElementTextToNumber(l[0]),d.comparedToLastWeekPercent=+u.getElementTextToNumber(l[1]),d.sameIndustryExcellent=+u.getElementTextToNumber(l[2]),d.newFensiCustomerCount=await this.processSubList(1,i),d.JoinAssociationCustomerCount=await this.processSubList(2,i),d.addPurchaseProductCustomerCount=await this.processSubList(3,i),d.consultingCustomerCount=await this.processSubList(4,i),d},n=async()=>{const i=this.root_OperationTarget_selector,l=this.root_OperationTarget().querySelectorAll(".low-repeater.repeater-wrapper >div:nth-child(3) span.value"),m=this.root_CustomerAction().querySelector(".common-scroll-container");u.waitForElementTextChange(async()=>{l[0].click()},m,1e3),await u.sleep(100);const d=new te;return d.viewLiveBroadcastCustomerCount=+u.getElementTextToNumber(l[0]),d.comparedToLastWeekPercent=+u.getElementTextToNumber(l[1]),d.sameIndustryExcellent=+u.getElementTextToNumber(l[2]),d.avgViewTime=await this.processSubList(1,i),d.liveBroadcastInteractionCustomerCount=await this.processSubList(2,i),d},s=async()=>{const i=this.root_OperationTarget_selector,l=this.root_OperationTarget().querySelectorAll(".low-repeater.repeater-wrapper >div:nth-child(4) span.value"),m=this.root_CustomerAction().querySelector(".common-scroll-container");u.waitForElementTextChange(async()=>{l[0].click()},m,1e3),await u.sleep(100);const d=new ee;return d.viewContentCustomerCount=+u.getElementTextToNumber(l[0]),d.comparedToLastWeekPercent=+u.getElementTextToNumber(l[1]),d.sameIndustryExcellent=+u.getElementTextToNumber(l[2]),d.shortVideoInteractionCustomerCount=await this.processSubList(1,i),d.ImageTextInteractionCustomerCount=await this.processSubList(2,i),d},c=async()=>{const i=this.root_OperationTarget_selector,l=this.root_OperationTarget().querySelectorAll(".low-repeater.repeater-wrapper >div:nth-child(5) span.value"),m=this.root_CustomerAction().querySelector(".common-scroll-container");u.waitForElementTextChange(async()=>{l[0].click()},m,1e3),await u.sleep(100);const d=new oe;return d.claimRightsCustomerCount=+u.getElementTextToNumber(l[0]),d.comparedToLastWeekPercent=+u.getElementTextToNumber(l[1]),d.sameIndustryExcellent=+u.getElementTextToNumber(l[2]),d.writeOff=await this.processSubList(1,i),d};return u.sendMessage(`正在抓取客户旅程-${this.rangeText}-运营对象统计-第${this.dataList.length+1}条,最多${this.totalDataCount}条,${this.startTime}-${this.endTime}`),t.protuctStatistics=await o(),t.storeStatistics=await r(),t.liveBroadcastStatistics=await n(),t.contentStatistics=await s(),t.rightsStatistics=await c(),t}async processProductList(){var t=[];const o=await tt(`${this.root_OperationTarget_selector} .ant-table-scroll tbody.ant-table-tbody`,2e3);if(!o)return t;u.scrollToElement(o);const r=async c=>{const i=new Ue;return i.productId=u.getElementText(c.querySelector("div.goodsInfo span.goods-subIndex-text")).split(":")[1],i.productName=u.getElementText(c.querySelector("div.goodsInfo p.singleGoodsName a")),i.productUrl=c.querySelector("div.goodsInfo p.singleGoodsName a").href,i.productImageUrl=c.querySelector("a.goodsImg img").src,i.viewCustomerCount=+u.getElementTextToNumber(c.querySelector("td:nth-child(2)")),i.collectingCustomerCount=+u.getElementTextToNumber(c.querySelector("td:nth-child(3)")),i.addPurchaseCustomerCount=+u.getElementTextToNumber(c.querySelector("td:nth-child(4)")),i.orderCustomerCount=+u.getElementTextToNumber(c.querySelector("td:nth-child(5)")),i.buyersCustomerCount=+u.getElementTextToNumber(c.querySelector("td:nth-child(6)")),i.paymentAmount=+u.getElementTextToNumber(c.querySelector("td:nth-child(7)")),i},n=async()=>{u.sendMessage(`正在抓取客户旅程-${this.rangeText}-运营对象统计-商品列表-第${t.length+1}条,最多${this.productListDataCount}条,${this.startTime}-${this.endTime}`);const c=o.querySelectorAll("tr.ant-table-row");for(let i=0;i<c.length;i++){const l=c[i],m=await r(l);if(t.push(m),t.length>=this.productListDataCount)break}await u.sleep(100)};await n();const s=this.root_OperationTarget().querySelector("ul.ant-pagination li:last-child");for(;t.length<this.productListDataCount&&s&&s.getAttribute("aria-disabled")!="true";)await u.waitForElementTextChange(async()=>{s.click()},o,1e3),await n();return t}}const Xe={matches:["https://sycm.taobao.com/cc/customer/overview*","https://sycm.taobao.com/cc/customer/trip*"],main:e=>{console.log("Hello sycm.taobao content."),ue(Qe)}};async function Qe(e,t){(e===B.taobao.domain||e===B.tmall.domain)&&document.querySelector(".baxia-dialog")&&document.querySelector(".baxia-dialog").remove();let o,r="unsupported";console.log("当前域名:",e),console.log("当前URL:",t),t.includes("/customer/overview")?(console.log("检测到生意参谋客户概况页面，开始抓取客户概况数据"),o=await We(),r="overview"):t.includes("/customer/trip")?(console.log("检测到生意参谋旅程分析页面，开始抓取旅程分析数据"),o=await Ge(),r="trip"):console.log("不是支持的生意参谋页面类型，抓取跳过");const n=new Date().toLocaleString(),s={domain:e,type:r,data:o,fetchTime:n};return console.log("抓取结果:",s),s}function ct(e,...t){}const ze={debug:(...e)=>ct(console.debug,...e),log:(...e)=>ct(console.log,...e),warn:(...e)=>ct(console.warn,...e),error:(...e)=>ct(console.error,...e)},lt=class lt extends Event{constructor(t,o){super(lt.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=o}};a(lt,"EVENT_NAME",Lt("wxt:locationchange"));let _t=lt;function Lt(e){var t;return`${(t=v==null?void 0:v.runtime)==null?void 0:t.id}:sycm_taobao:${e}`}function Ze(e){let t,o;return{run(){t==null&&(o=new URL(location.href),t=e.setInterval(()=>{let r=new URL(location.href);r.href!==o.href&&(window.dispatchEvent(new _t(r,o)),o=r)},1e3))}}}const X=class X{constructor(t,o){a(this,"isTopFrame",window.self===window.top);a(this,"abortController");a(this,"locationWatcher",Ze(this));a(this,"receivedMessageIds",new Set);this.contentScriptName=t,this.options=o,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return v.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,o){const r=setInterval(()=>{this.isValid&&t()},o);return this.onInvalidated(()=>clearInterval(r)),r}setTimeout(t,o){const r=setTimeout(()=>{this.isValid&&t()},o);return this.onInvalidated(()=>clearTimeout(r)),r}requestAnimationFrame(t){const o=requestAnimationFrame((...r)=>{this.isValid&&t(...r)});return this.onInvalidated(()=>cancelAnimationFrame(o)),o}requestIdleCallback(t,o){const r=requestIdleCallback((...n)=>{this.signal.aborted||t(...n)},o);return this.onInvalidated(()=>cancelIdleCallback(r)),r}addEventListener(t,o,r,n){var s;o==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),(s=t.addEventListener)==null||s.call(t,o.startsWith("wxt:")?Lt(o):o,r,{...n,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),ze.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:X.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){var s,c,i;const o=((s=t.data)==null?void 0:s.type)===X.SCRIPT_STARTED_MESSAGE_TYPE,r=((c=t.data)==null?void 0:c.contentScriptName)===this.contentScriptName,n=!this.receivedMessageIds.has((i=t.data)==null?void 0:i.messageId);return o&&r&&n}listenForNewerScripts(t){let o=!0;const r=n=>{if(this.verifyScriptStartedEvent(n)){this.receivedMessageIds.add(n.data.messageId);const s=o;if(o=!1,s&&(t!=null&&t.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",r),this.onInvalidated(()=>removeEventListener("message",r))}};a(X,"SCRIPT_STARTED_MESSAGE_TYPE",Lt("wxt:content-script-started"));let Pt=X;function ro(){}function ut(e,...t){}const to={debug:(...e)=>ut(console.debug,...e),log:(...e)=>ut(console.log,...e),warn:(...e)=>ut(console.warn,...e),error:(...e)=>ut(console.error,...e)};return(async()=>{try{const{main:e,...t}=Xe,o=new Pt("sycm_taobao",t);return await e(o)}catch(e){throw to.error('The content script "sycm_taobao" crashed on startup!',e),e}})()}();
sycmtaobao;
