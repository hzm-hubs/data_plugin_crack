var youtube=function(){"use strict";var Rt=Object.defineProperty;var Vt=($,M,y)=>M in $?Rt($,M,{enumerable:!0,configurable:!0,writable:!0,value:y}):$[M]=y;var g=($,M,y)=>Vt($,typeof M!="symbol"?M+"":M,y);var $e,He;function $(t){return t}const y=(He=($e=globalThis.browser)==null?void 0:$e.runtime)!=null&&He.id?globalThis.browser:globalThis.chrome,Q={"sycm.taobao":{name:"生意参谋",domain:"sycm.taobao",fullDomain:"sycm.taobao.com"},"one.alimama":{name:"阿里妈妈万象台",domain:"one.alimama",fullDomain:"one.alimama.com"},taobao:{name:"淘宝",domain:"taobao",fullDomain:"taobao.com"},tmall:{name:"天猫",domain:"tmall",fullDomain:"tmall.com"},tmallhk:{name:"天猫国际",domain:"tmallhk",fullDomain:"tmall.hk"},douyin:{name:"抖音",domain:"douyin",fullDomain:"douyin.com"},xiaohongshu:{name:"小红书",domain:"xiaohongshu",fullDomain:"xiaohongshu.com"},jd:{name:"京东",domain:"jd",fullDomain:"jd.com"},tiktok:{name:"tiktok",domain:"tiktok",fullDomain:"tiktok.com"},youtube:{name:"youtube",domain:"youtube",fullDomain:"youtube.com"},other:{name:"其他",domain:"other",fullDomain:"other"}};function We(t){console.log("getDomain",t),t||(t=window.location.href);for(let e in Q)if(t.includes(Q[e].fullDomain))return Q[e].domain;return Q.other.domain}function qe(t,e="data_"){return t&&t.indexOf("https://sycm.taobao.com/cc/customer/trip")===0?t="https://sycm.taobao.com/cc/customer/trip":t&&t.indexOf("https://sycm.taobao.com/cc/customer/overview")===0?t="https://sycm.taobao.com/cc/customer/overview":t&&t.indexOf("https://one.alimama.com/index.html#!/manage/onesite")===0&&(t="https://one.alimama.com/index.html#!/manage/onesite"),e+btoa(t)}class je{constructor(){g(this,"sleep",e=>new Promise(n=>setTimeout(n,e)));g(this,"runDelay",async(e,n)=>new Promise(r=>setTimeout(()=>{r(e())},n)));g(this,"sendMessage",e=>{y.runtime.sendMessage({action:"updateStatus",status:e})});g(this,"sendDataWithAction",(e,n)=>{y.runtime.sendMessage({action:n,data:e})});g(this,"openPopup",(e=-1)=>{y.runtime.sendMessage({action:"openPopup",windowId:e})});g(this,"openSidePanel",(e=-1)=>{y.runtime.sendMessage({action:"openSidePanel",windowId:e})});g(this,"elementHover",(e,n=!0)=>{e.dispatchEvent(new MouseEvent(n?"mouseover":"mouseout",{bubbles:!0}))});g(this,"setElementAnimation",e=>{const n="266A247A-6C68-4F89-8D11-B767B4E7A71C",r="animation_"+n.slice(0,8),o="class_"+n.slice(0,8);if(!document.head.querySelector(`style[data-id='${n}']`)){const a=document.createElement("style");a.type="text/css",a.setAttribute("data-id",n);const i=`
      @keyframes ${r}{
        to {  background-color :rgb(255, 0, 0);
              border: 1px solid blue;
              border-radius: 3px;
        }
      }
    `,s=`
      .${o} {
        animation: ${r} 0.5s ease-in-out 0s 2 alternate none;
      }
    `;a.innerHTML=i+s,document.head.appendChild(a)}return e.classList.remove(o),e.offsetHeight,e.classList.add(o),e});g(this,"waitForChildListChange",async(e,n,r=5e3)=>new Promise((o,a)=>{const i=setTimeout(()=>{s&&(s.disconnect(),console.log("等待元素更新超时: ",n,`超时时间：${r}ms`),o(!1))},r),s=new MutationObserver((l,u)=>{if(l.length>0)for(const d of l)if(d.type==="attributes")d.attributeName;else if(d.type==="childList"){clearTimeout(i),u.disconnect(),o(!0);return}else d.type});s.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0}),e&&e()}));g(this,"waitForElementTextChange",async(e,n,r=5e3)=>new Promise((o,a)=>{console.log("等待元素更新:",n,` 超时: ${r}ms`);const i=setTimeout(()=>{s&&(s.disconnect(),console.log("等待元素更新超时: ",n,`超时时间：${r}ms`),o(!1))},r),s=new MutationObserver((l,u)=>{if(l.length>0){for(const d of l)if(d.type==="attributes")d.attributeName;else if(d.type!=="childList"){if(d.type==="characterData"){clearTimeout(i),u.disconnect(),o(!0);return}}}});s.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0}),e&&e()}));g(this,"waitForElementAttrChange",async(e,n,r=5e3)=>new Promise((o,a)=>{console.log("等待元素属性更新:",n,` 超时: ${r}ms`);const i=setTimeout(()=>{s&&(s.disconnect(),console.log("等待元素属性更新超时: ",n,`超时时间：${r}ms`),o(!1))},r),s=new MutationObserver((l,u)=>{if(l.length>0)for(const d of l)if(d.type==="attributes"){d.attributeName,clearTimeout(i),u.disconnect(),o(!0);return}else d.type==="childList"||d.type});s.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0}),e&&e()}));g(this,"waitForElementListTextChange",async(e,n,r=5e3,o=!0)=>{let a=[];return new Promise((i,s)=>{n.forEach(l=>{this.waitForElementTextChange(()=>{},l,r).then(async u=>{a.push({target:l,result:u}),o?a.length===n.length&&i(a):a.length==1&&(await this.sleep(500),i(a))})}),e&&e()})});g(this,"waitForElementListAttrChange",async(e,n,r=5e3,o=!0)=>{let a=[];return new Promise((i,s)=>{n.forEach(l=>{this.waitForElementAttrChange(()=>{},l,r).then(async u=>{a.push({target:l,result:u}),o?a.length===n.length&&i(a):a.length==1&&(await this.sleep(500),i(a))})}),e&&e()})});g(this,"waitForElementRemove",async(e,n=5e3)=>new Promise((r,o)=>{const i=n/10;let s=0;const l=setInterval(()=>{if(!document.querySelector(e)){clearInterval(l),r(!0);return}s++,s<i?console.log("等待元素移除:",e,` 超时: ${n}ms`,`剩余时间：${n-s*10}ms`):(console.log("等待元素移除超时: ",e,`超时时间：${n}ms`),clearInterval(l),o(!1))},10)}));g(this,"scrollToElementTop",e=>{e.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})});g(this,"scrollToElement",e=>{e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})});g(this,"scrollToElementBottom",e=>{e.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})});g(this,"ensureElementVisible",e=>{let n=e;for(;n&&n!==document.body;){const s=n.parentElement;if(!s)break;const l=s.scrollHeight>s.clientHeight,u=s.scrollWidth>s.clientWidth;if(l||u){const d=s.getBoundingClientRect(),h=n.getBoundingClientRect();l&&(h.top<d.top?s.scrollTop-=d.top-h.top:h.bottom>d.bottom&&(s.scrollTop+=h.bottom-d.bottom)),u&&(h.left<d.left?s.scrollLeft-=d.left-h.left:h.right>d.right&&(s.scrollLeft+=h.right-d.right))}n=s}const r=window.scrollY,o=r+window.innerHeight,a=e.offsetTop,i=a+e.offsetHeight;a<r?window.scrollTo({top:a,behavior:"smooth"}):i>o&&window.scrollTo({top:i-window.innerHeight,behavior:"smooth"})});g(this,"getTextNodeValue",(e,n=!1)=>{this.setElementAnimation(e);const r=Array.from(e.childNodes).filter(o=>o.nodeType===Node.TEXT_NODE).map(o=>o.textContent).join("");return n?+r.replace(/[^\d-.]/g,""):r});g(this,"getElementText",(e,n=!0)=>e?(n&&this.setElementAnimation(e),e.textContent):"");g(this,"getElementTextToNumber",(e,n=!0)=>{if(e){const r=this.getElementText(e,n).replace(/[^\d-.]/g,"");return r&&!isNaN(r)?+r:r}return 0});g(this,"getUserInputNumber",async(e=10,n="请输入最大数据条数，默认10条，最小1条，最大100条",r=100)=>{let o=await this.showInput(n,e,r);for(;o;){let a=0;if(!isNaN(o)&&(a=parseInt(o),a>0&&a<=r)){e=a;break}o=await this.showInput(n,e,r)}return e});g(this,"waitElementInViewportUseObserver",async(e,n=5e3)=>new Promise((r,o)=>{this.isElementInViewport(e)&&r(!0),setTimeout(()=>{r(!1),a.disconnect()},n);const a=new IntersectionObserver(i=>{i.forEach(async s=>{s.isIntersecting&&(r(!0),a.disconnect())})});if(!e)return o("元素不存在");this.scrollToElement(e),a.observe(e)}));g(this,"waitElementInViewportUseClientRect",async(e,n=!1,r=5e3)=>{new Promise(async(o,a)=>{if(!e||typeof e.getBoundingClientRect!="function")return o(!1);let i=null;const s=()=>{const h=e.getBoundingClientRect(),m=window.innerHeight||document.documentElement.clientHeight,I=window.innerWidth||document.documentElement.clientWidth;let v=!1;if(n)v=h.top>=0&&h.bottom<=m&&h.left>=0&&h.right<=I;else{const S=h.top<=m&&h.bottom>=0,_=h.left<=I&&h.right>=0;v=S&&_}v&&(i&&clearInterval(i),o(!0))},l=10,u=parseInt(r/l+"")>0?parseInt(r/l+""):1;let d=0;i=setInterval(()=>{d++,d>u?(i&&clearInterval(i),o(!1)):s()},l)})});g(this,"isElementInViewport",e=>{const n=e.getBoundingClientRect(),r=window.innerHeight||document.documentElement.clientHeight,o=window.innerWidth||document.documentElement.clientWidth;return n.top<r&&n.bottom>0&&n.left<o&&n.right>0});g(this,"getItemTextAndLog",(e,n,r,o="")=>{const a=this.querySelector(e,n);let i=this.getElementText(a);return o&&(i=(a==null?void 0:a.getAttribute(o))||""),r&&!a&&console.log(r),i});g(this,"waitForResult",async(e,n=5e3)=>{const r=Math.floor(n/100);for(let o=0;o<r;o++){if(await e())return!0;await this.sleep(100)}return!1});g(this,"getNumberText",e=>{const n=e.match(/[\.\d]+(千万)?(万亿)?[万|亿|k|K|m|M|b|B]?/);return n?n[0]:e})}deepScroll(e){return new Promise((n,r)=>{const o=[],a={element:e.element||window,duration:e.duration||500,easing:e.easing||"easeInOutQuad",scrollContainers:o,left:e.left,top:e.top,target:e.target,callback:e.callback};function i(f){const b=[];let p=f;for(;p&&p!==document.documentElement;)s(p)&&b.push(p),p=p.parentElement;return l()&&b.push(window),b}function s(f){if(f===window||!(f instanceof HTMLElement))return!0;const b=getComputedStyle(f),p=b.overflowY==="auto"||b.overflowY==="scroll",A=b.overflowX==="auto"||b.overflowX==="scroll";return p&&f.scrollHeight>f.clientHeight||A&&f.scrollWidth>f.clientWidth}function l(){return document.documentElement.scrollHeight>window.innerHeight}function u(f,b){const p=b.getBoundingClientRect();if(f instanceof Window)return{top:d(p.top-window.pageYOffset+window.outerHeight,p.height,window.innerHeight,window.outerHeight),left:d(p.left-window.pageXOffset+window.outerWidth,p.width,window.innerWidth,window.outerWidth)};const A=f.getBoundingClientRect();return{top:d(p.top-A.top+f.scrollTop,p.height,f.clientHeight,f.scrollTop),left:d(p.left-A.left+f.scrollLeft,p.width,f.clientWidth,f.scrollLeft)}}function d(f,b,p,A){const j=A,G=A+p,x=f+b;return f>=j&&x<=G?A:f<j?f:x-p}function h(f){return f instanceof Window?window.pageYOffset:f.scrollTop}function m(f){return f instanceof Window?window.pageXOffset:f.scrollLeft}function I(f,b,p){f instanceof Window?window.scrollTo(p,b):(f.scrollTop=b,f.scrollLeft=p)}if(a.target){const f=i(a.target);let b=a.target;f.forEach(p=>{const A=u(p,b);a.scrollContainers.push({element:p,startTop:h(p),targetTop:A.top,startLeft:m(p),targetLeft:A.left}),b=p})}else a.scrollContainers.push({element:a.element,startTop:h(a.element),targetTop:a.top??h(a.element),startLeft:m(a.element),targetLeft:a.left??m(a.element)});const v={linear:f=>f,easeInQuad:f=>f*f,easeOutQuad:f=>f*(2-f),easeInOutQuad:f=>f<.5?2*f*f:-1+(4-2*f)*f},S=v[a.easing]||v.easeInOutQuad;let _=0;const O=()=>{var f;n(""),a.target,(f=a.callback)==null||f.call(a)},q=f=>{_||(_=f);const b=f-_,p=Math.min(b/a.duration,1),A=S(p);a.scrollContainers.forEach(({element:j,startTop:G,targetTop:x,startLeft:T,targetLeft:E})=>{const Se=G+(x-G)*A,N=T+(E-T)*A;I(j,Se,N)}),b<a.duration?requestAnimationFrame(q):O()};requestAnimationFrame(q)})}async showInput(e,n,r){return new Promise((o,a)=>{y.runtime.sendMessage({action:"showInput",placeholder:e,defaultValue:n,max:r},i=>{o(i.value)})})}simpleUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const n=Math.random()*16|0;return(e==="x"?n:n&3|8).toString(16)})}formatDateTime(e,n=!1){if(typeof e=="string")e=new Date(e);else if(typeof e=="number")e=new Date(e);else if(!(e instanceof Date))return"";if(isNaN(e))return"";const r={year:e.getFullYear(),mounth:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),ms:e.getMilliseconds()},o=(i,s=2)=>(i+"").padStart(s,"0");let a=`${r.year}-${o(r.mounth)}-${o(r.day)} ${o(r.hour)}:${o(r.minute)}:${o(r.second)}`;return n&&(a+=`:${r.ms}`),a}formatDate(e){const n=this.formatDateTime(e);return n?n.split(" ")[0]:""}parseChineseNumber(e){const n={万亿:1e12,千亿:1e11,百亿:1e10,十亿:1e9,亿:1e8,千万:1e7,百万:1e6,万:1e4,千:1e3,百:100,十:10,k:1e3,K:1e3,m:1e6,M:1e6,b:1e9,B:1e9,t:1e12,T:1e12};let r="";for(const u in n)r?r+="|"+u:r+=u;const o=String(e).match(new RegExp(`^(\\d+.?\\d*)([${r})]*)`));if(!o)return 0;const a=parseFloat(o[1]),i=o[2].trim(),s=Object.keys(n).find(u=>i.startsWith(u)),l=s?n[s]:1;return i==="千万"?a*1e7:a*l}querySelector(e,n=[]){let r=null;for(const o of n){const a=o.match(/(.+):contains\(['"](.+)['"]\)/);if(a){const i=a[1],s=a[2];if(r=e.querySelector(i),r&&r.textContent.includes(s))break}else if(r=e.querySelector(o),r)break}return r}querySelectorAll(e,n=[]){for(const r of n){const o=r.match(/(.+):contains\(['"](.+)['"]\)/);if(o){const a=o[1],i=o[2],s=e.querySelectorAll(a);if(s&&s.length>0)return Array.from(s).filter(u=>u.textContent.includes(i))}else{const a=e.querySelectorAll(r);if(a.length>0)return Array.from(a)}}return[]}querySelectorWithText(e,n=[],r=""){let o=null;for(const a of n)if(o=e.querySelectorAll(a),o.length>0){for(const i of o)if(i.textContent.includes(r))return i}return null}querySelectorAllWithText(e,n=[],r=""){let o=null;for(const a of n)if(o=e.querySelectorAll(a),o.length>0)return Array.from(o).filter(i=>i.textContent.includes(r));return[]}}const c=new je;function Fe(t){y.runtime.onMessage.addListener((e,n,r)=>{if(e.action==="getData")return console.log("收到获取数据请求"),(async()=>{try{const o=await ke(t);y.runtime.sendMessage({action:"dataReceived",data:o}),r({data:o})}catch(o){console.error("抓取数据时出错:",o),y.runtime.sendMessage({action:"dataError",error:o.message})}})(),r({action:"__default"}),!0})}async function ke(t){const e=window.location.href,n=qe(e),r=We(e);try{const o=await t(r,e);return console.log(`抓取到${r}数据:`,o),o.type=="unsupported"&&c.sendMessage("前页面不支持数据抓取"),await y.storage.local.set({[n]:{domain:r,type:o.type,data:o.data,timestamp:new Date().getTime(),fetchTime:o.fetchTime,url:e}}),o}catch(o){throw console.error("抓取过程中发生错误:",o),o}}const R={sniffedVideoUrl:"",sniffedVideoUrls:Array(),videoSearchAttempts:0};/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Ke(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Be=Object.assign,Ye=Object.prototype.hasOwnProperty,se=(t,e)=>Ye.call(t,e),H=Array.isArray,z=t=>_e(t)==="[object Map]",Xe=t=>typeof t=="string",F=t=>typeof t=="symbol",Z=t=>t!==null&&typeof t=="object",Ge=Object.prototype.toString,_e=t=>Ge.call(t),Qe=t=>_e(t).slice(8,-1),ie=t=>Xe(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,J=(t,e)=>!Object.is(t,e);/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ze,Ae=0,le;function ce(){Ae++}function ue(){if(--Ae>0)return;let t;for(;le;){let e=le;for(le=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){t||(t=r)}e=n}}if(t)throw t}let ee=!0;const Le=[];function Ze(){Le.push(ee),ee=!1}function Je(){const t=Le.pop();ee=t===void 0?!0:t}class et{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){}trigger(e){this.version++,this.notify(e)}notify(e){ce();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{ue()}}}const de=new WeakMap,U=Symbol(""),fe=Symbol(""),k=Symbol("");function L(t,e,n){if(ee&&ze){let r=de.get(t);r||de.set(t,r=new Map);let o=r.get(n);o||(r.set(n,o=new et),o.map=r,o.key=n),o.track()}}function D(t,e,n,r,o,a){const i=de.get(t);if(!i)return;const s=l=>{l&&l.trigger()};if(ce(),e==="clear")i.forEach(s);else{const l=H(t),u=l&&ie(n);if(l&&n==="length"){const d=Number(r);i.forEach((h,m)=>{(m==="length"||m===k||!F(m)&&m>=d)&&s(h)})}else switch((n!==void 0||i.has(void 0))&&s(i.get(n)),u&&s(i.get(k)),e){case"add":l?u&&s(i.get("length")):(s(i.get(U)),z(t)&&s(i.get(fe)));break;case"delete":l||(s(i.get(U)),z(t)&&s(i.get(fe)));break;case"set":z(t)&&s(i.get(U));break}}ue()}function W(t){const e=w(t);return e===t?e:(L(e,"iterate",k),P(t)?e:e.map(C))}function he(t){return L(t=w(t),"iterate",k),t}const tt={__proto__:null,[Symbol.iterator](){return me(this,Symbol.iterator,C)},concat(...t){return W(this).concat(...t.map(e=>H(e)?W(e):e))},entries(){return me(this,"entries",t=>(t[1]=C(t[1]),t))},every(t,e){return V(this,"every",t,e,void 0,arguments)},filter(t,e){return V(this,"filter",t,e,n=>n.map(C),arguments)},find(t,e){return V(this,"find",t,e,C,arguments)},findIndex(t,e){return V(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return V(this,"findLast",t,e,C,arguments)},findLastIndex(t,e){return V(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return V(this,"forEach",t,e,void 0,arguments)},includes(...t){return ge(this,"includes",t)},indexOf(...t){return ge(this,"indexOf",t)},join(t){return W(this).join(t)},lastIndexOf(...t){return ge(this,"lastIndexOf",t)},map(t,e){return V(this,"map",t,e,void 0,arguments)},pop(){return K(this,"pop")},push(...t){return K(this,"push",t)},reduce(t,...e){return Ee(this,"reduce",t,e)},reduceRight(t,...e){return Ee(this,"reduceRight",t,e)},shift(){return K(this,"shift")},some(t,e){return V(this,"some",t,e,void 0,arguments)},splice(...t){return K(this,"splice",t)},toReversed(){return W(this).toReversed()},toSorted(t){return W(this).toSorted(t)},toSpliced(...t){return W(this).toSpliced(...t)},unshift(...t){return K(this,"unshift",t)},values(){return me(this,"values",C)}};function me(t,e,n){const r=he(t),o=r[e]();return r!==t&&!P(t)&&(o._next=o.next,o.next=()=>{const a=o._next();return a.value&&(a.value=n(a.value)),a}),o}const nt=Array.prototype;function V(t,e,n,r,o,a){const i=he(t),s=i!==t&&!P(t),l=i[e];if(l!==nt[e]){const h=l.apply(t,a);return s?C(h):h}let u=n;i!==t&&(s?u=function(h,m){return n.call(this,C(h),m,t)}:n.length>2&&(u=function(h,m){return n.call(this,h,m,t)}));const d=l.call(i,u,r);return s&&o?o(d):d}function Ee(t,e,n,r){const o=he(t);let a=n;return o!==t&&(P(t)?n.length>3&&(a=function(i,s,l){return n.call(this,i,s,l,t)}):a=function(i,s,l){return n.call(this,i,C(s),l,t)}),o[e](a,...r)}function ge(t,e,n){const r=w(t);L(r,"iterate",k);const o=r[e](...n);return(o===-1||o===!1)&&wt(n[0])?(n[0]=w(n[0]),r[e](...n)):o}function K(t,e,n=[]){Ze(),ce();const r=w(t)[e].apply(t,n);return ue(),Je(),r}const ot=Ke("__proto__,__v_isRef,__isVue"),Ce=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(F));function rt(t){F(t)||(t=String(t));const e=w(this);return L(e,"has",t),e.hasOwnProperty(t)}class Re{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,r){if(n==="__v_skip")return e.__v_skip;const o=this._isReadonly,a=this._isShallow;if(n==="__v_isReactive")return!o;if(n==="__v_isReadonly")return o;if(n==="__v_isShallow")return a;if(n==="__v_raw")return r===(o?a?mt:De:a?ht:Me).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const i=H(e);if(!o){let l;if(i&&(l=tt[n]))return l;if(n==="hasOwnProperty")return rt}const s=Reflect.get(e,n,Y(e)?e:r);return(F(n)?Ce.has(n):ot(n))||(o||L(e,"get",n),a)?s:Y(s)?i&&ie(n)?s:s.value:Z(s)?o?Oe(s):we(s):s}}class at extends Re{constructor(e=!1){super(!1,e)}set(e,n,r,o){let a=e[n];if(!this._isShallow){const l=B(a);if(!P(r)&&!B(r)&&(a=w(a),r=w(r)),!H(e)&&Y(a)&&!Y(r))return l?!1:(a.value=r,!0)}const i=H(e)&&ie(n)?Number(n)<e.length:se(e,n),s=Reflect.set(e,n,r,Y(e)?e:o);return e===w(o)&&(i?J(r,a)&&D(e,"set",n,r):D(e,"add",n,r)),s}deleteProperty(e,n){const r=se(e,n);e[n];const o=Reflect.deleteProperty(e,n);return o&&r&&D(e,"delete",n,void 0),o}has(e,n){const r=Reflect.has(e,n);return(!F(n)||!Ce.has(n))&&L(e,"has",n),r}ownKeys(e){return L(e,"iterate",H(e)?"length":U),Reflect.ownKeys(e)}}class st extends Re{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const it=new at,lt=new st,pe=t=>t,te=t=>Reflect.getPrototypeOf(t);function ct(t,e,n){return function(...r){const o=this.__v_raw,a=w(o),i=z(a),s=t==="entries"||t===Symbol.iterator&&i,l=t==="keys"&&i,u=o[t](...r),d=n?pe:e?be:C;return!e&&L(a,"iterate",l?fe:U),{next(){const{value:h,done:m}=u.next();return m?{value:h,done:m}:{value:s?[d(h[0]),d(h[1])]:d(h),done:m}},[Symbol.iterator](){return this}}}}function ne(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function ut(t,e){const n={get(o){const a=this.__v_raw,i=w(a),s=w(o);t||(J(o,s)&&L(i,"get",o),L(i,"get",s));const{has:l}=te(i),u=e?pe:t?be:C;if(l.call(i,o))return u(a.get(o));if(l.call(i,s))return u(a.get(s));a!==i&&a.get(o)},get size(){const o=this.__v_raw;return!t&&L(w(o),"iterate",U),Reflect.get(o,"size",o)},has(o){const a=this.__v_raw,i=w(a),s=w(o);return t||(J(o,s)&&L(i,"has",o),L(i,"has",s)),o===s?a.has(o):a.has(o)||a.has(s)},forEach(o,a){const i=this,s=i.__v_raw,l=w(s),u=e?pe:t?be:C;return!t&&L(l,"iterate",U),s.forEach((d,h)=>o.call(a,u(d),u(h),i))}};return Be(n,t?{add:ne("add"),set:ne("set"),delete:ne("delete"),clear:ne("clear")}:{add(o){!e&&!P(o)&&!B(o)&&(o=w(o));const a=w(this);return te(a).has.call(a,o)||(a.add(o),D(a,"add",o,o)),this},set(o,a){!e&&!P(a)&&!B(a)&&(a=w(a));const i=w(this),{has:s,get:l}=te(i);let u=s.call(i,o);u||(o=w(o),u=s.call(i,o));const d=l.call(i,o);return i.set(o,a),u?J(a,d)&&D(i,"set",o,a):D(i,"add",o,a),this},delete(o){const a=w(this),{has:i,get:s}=te(a);let l=i.call(a,o);l||(o=w(o),l=i.call(a,o)),s&&s.call(a,o);const u=a.delete(o);return l&&D(a,"delete",o,void 0),u},clear(){const o=w(this),a=o.size!==0,i=o.clear();return a&&D(o,"clear",void 0,void 0),i}}),["keys","values","entries",Symbol.iterator].forEach(o=>{n[o]=ct(o,t,e)}),n}function Ve(t,e){const n=ut(t,e);return(r,o,a)=>o==="__v_isReactive"?!t:o==="__v_isReadonly"?t:o==="__v_raw"?r:Reflect.get(se(n,o)&&o in r?n:r,o,a)}const dt={get:Ve(!1,!1)},ft={get:Ve(!0,!1)},Me=new WeakMap,ht=new WeakMap,De=new WeakMap,mt=new WeakMap;function gt(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function pt(t){return t.__v_skip||!Object.isExtensible(t)?0:gt(Qe(t))}function we(t){return B(t)?t:Ne(t,!1,it,dt,Me)}function Oe(t){return Ne(t,!0,lt,ft,De)}function Ne(t,e,n,r,o){if(!Z(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const a=pt(t);if(a===0)return t;const i=o.get(t);if(i)return i;const s=new Proxy(t,a===2?r:n);return o.set(t,s),s}function B(t){return!!(t&&t.__v_isReadonly)}function P(t){return!!(t&&t.__v_isShallow)}function wt(t){return t?!!t.__v_raw:!1}function w(t){const e=t&&t.__v_raw;return e?w(e):t}const C=t=>Z(t)?we(t):t,be=t=>Z(t)?Oe(t):t;function Y(t){return t?t.__v_isRef===!0:!1}/*!
 * pinia v3.0.3
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */var Ue;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Ue||(Ue={}));const ve=()=>({feishu:{label:"飞书多维表格设置",feishu_base_url:{value:"",max:200,defalutVaue:"",label:"多维表格URL",placeholder:"多维表格URL 例如: https://mideqnf1p7d.feishu.cn/base/TAAsbKNniaMaodss84tcEQSun3f?table=tbllpvh8BykaNQBM&view=vewvd05oOX"}},dignding:{label:"钉钉AI表格设置",appKey:{value:"",max:100,defalutVaue:"",label:"appKey",placeholder:"appKey"},appSecret:{value:"",max:100,defalutVaue:"",label:"appSecret",placeholder:"appSecret"},baseId:{value:"",max:100,defalutVaue:"",label:"baseId",placeholder:"baseId 文档Id"},phone:{value:"",max:100,defalutVaue:"",label:"手机号",placeholder:"钉钉用户绑定的手机号码"}},douyin:{label:"抖音设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxUserVideoCount:{value:100,max:200,defalutVaue:100,label:"最大用户视频数量",placeholder:"最大用户视频数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},xiaohongshu:{label:"小红书设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxUserNoteCount:{value:100,max:200,defalutVaue:100,label:"最大用户笔记数量",placeholder:"最大用户笔记数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},jd:{label:"京东设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},taobao:{label:"淘宝设置",maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},sycm_taobao:{label:"生意参谋设置",maxOverviewDataCount:{value:100,max:200,defalutVaue:100,label:"最大客户概况数量",placeholder:"最大客户概况数量"},maxCustomerTripDataCount:{value:100,max:200,defalutVaue:100,label:"最大客户旅程数量",placeholder:"最大客户旅程数量"},maxCustomerTripGoodsDataCount:{value:100,max:200,defalutVaue:100,label:"最大客户旅程商品数量",placeholder:"最大客户旅程商品数量"}},one_alimama:{label:"阿里妈妈万象台设置",maxGoodsListCount:{value:100,max:200,defalutVaue:100,label:"最大商品数量",placeholder:"最大商品数量"}},tiktok:{label:"tiktok设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxUserVideoCount:{value:100,max:200,defalutVaue:100,label:"最大用户视频数量",placeholder:"最大用户视频数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}},youtube:{label:"tiktok设置",maxSearchListCount:{value:100,max:200,defalutVaue:100,label:"搜索列表数量",placeholder:"搜索列表数量"},maxUserVideoCount:{value:100,max:200,defalutVaue:100,label:"最大用户视频数量",placeholder:"最大用户视频数量"},maxCommentsCount:{value:100,max:200,defalutVaue:100,label:"最大评论数量",placeholder:"最大评论数量"}}});let bt=ve();we(bt);const Pe="__setting",xe=async()=>{var e=(await y.storage.local.get([Pe]))[Pe];if(e){const r=e;var n=ve();return Object.keys(n).forEach(o=>{o in r||(r[o]=n[o])}),r}else return ve()};async function vt(){console.log("开始抓取youtube视频详情..."),console.log("当前URL:",window.location.href);var t="youtube";const n=(await xe())[t].maxCommentsCount.value;R.sniffedVideoUrl="",R.sniffedVideoUrls?console.log("已有嗅探视频URL列表，共",R.sniffedVideoUrls.length,"个"):R.sniffedVideoUrls=[],R.videoSearchAttempts=0;let r=new URL("https://www.youtube.com/watch?v=Bykg8ZgKA-o&t=72s").searchParams.get("v")||"";for(let x=0;x<3;x++){let T=Array.from(document.querySelectorAll("video"));T.length==2?T=[T[0]]:T.length>2&&(T=[T[1]]);for(const E of T)await c.sleep(500),E.src&&E.src.startsWith("https:")&&(R.sniffedVideoUrl=E.src,console.log("在视频元素中找到视频URL:",R.sniffedVideoUrl)),E.querySelectorAll("source").forEach(N=>{N.src&&(console.log("发现视频source标签src:",N.src),N.src.startsWith("https:")&&(R.sniffedVideoUrl=N.src,console.log("在source标签中找到视频URL:",R.sniffedVideoUrl)))});if(R.sniffedVideoUrl){console.log("成功找到视频URL，中止进一步搜索");break}x<2&&(console.log("未找到视频URL，等待500ms后再次尝试"),await new Promise(E=>setTimeout(E,500)))}R.sniffedVideoUrl||console.log("没有立即找到视频URL，将在后台继续嗅探"),console.log('通过div[role="dialog"]属性查找当前视频元素...');let o=c.querySelector(document,["#primary #primary-inner","#primary"," #primary-inner"]);if(!o){let x=c.querySelectorAll(document,["#column-list-container>article",'[class*="DivColumnListContainer"]>article']);for(let T=0;T<x.length;T++){let E=x[T];if(c.isElementInViewport(E)){o=E;break}}}if(!o)return console.error("未找到视频modal容器"),console.log("当前页面结构:"),console.log(document.body.innerHTML.substring(0,500)+"..."),c.runDelay(()=>{c.sendMessage("未找到视频详情容器，当前页面不支持抓取视频详情")},1e3),null;console.log("Modal container HTML (前300字符):"),console.log(o.innerHTML.substring(0,300)+"...");let a="",i=c.getItemTextAndLog(o,["#above-the-fold #title>h1","#above-the-fold #title>"],"未找到标题");const s=["#channel-name #text-container a","#channel-name a","#text-container a"];let l=c.getItemTextAndLog(o,s,"未找到作者"),u=c.getItemTextAndLog(o,s,"未找到作者id","href");u.indexOf("/@")>-1&&(u=u.split("/@")[1]);let d=c.getItemTextAndLog(o,s,"未找到作者id","href"),h=c.getItemTextAndLog(o,["#avatar img"],"未找到作者头像","src"),m=c.getItemTextAndLog(o,["#date-text"],"未找到发布时间","aria-label");var I=c.querySelectorAll(o,["#actions #top-level-buttons-computed .animatedRollingNumberHost>.animatedRollingCharacterHost"]);let v="";I&&I.length>0?I.forEach(x=>{let T=x.getAttribute("style");if(T&&T.includes("margin-top")){const E=T.match(/margin-top: (\d+)px;/);if(E){const N=parseInt(E[1])/36%10;v+=N+""}else console.log("未找到匹配的样式")}else console.log("点赞数元素不包含margin-top样式")}):v=c.getItemTextAndLog(o,["#top-level-buttons-computed like-button-view-model"],"未找到点赞数");let S=c.getItemTextAndLog(o,["#header #title>#leading-section>#count span"],"未找到评论数"),_="",O="",q=c.getItemTextAndLog(o,[".ytp-time-duration"],"未找到视频时长"),f="";const b=c.querySelectorAll(o,["#info-container #info>a"]);f=b.map(x=>c.getElementText(x)).join(","),b.length>0?console.log("提取到标签:",f):console.log("未找到标签");let p="";const A=c.parseChineseNumber(S),j=await xt(A>n?n:A);return{author:{id:u,name:l,avatar:h,link:d},post:{id:r,title:i,coverImage:a,description:i,link:window.location.href,duration:q,publishTime:m,musicInfo:p,tags:f},interactions:{likes:v,comments:S,favorites:_,shares:O},mediaContent:[{type:"video",mediaUrl:R.sniffedVideoUrl,cover:""}],commentsList:j.map(x=>({userName:x.userName||"",avatar:x.avatar||"",content:x.content||"",likes:x.likes||"0",date:x.date||"",location:x.location||"",isAuthor:x.isAuthor||!1}))}}async function xt(t=100){if(t<=0)return[];console.log(`开始抓取视频评论，最多 ${t} 条`);const e=["#comments #sections>#contents","#sections>#contents"];let n=c.querySelector(document,[...e]);if(!n)return console.error(`未找到评论容器 ${e}`),[];const r=()=>c.querySelectorAll(n,["ytd-comment-thread-renderer.ytd-item-section-renderer[use-small-avatars]","ytd-comment-thread-renderer]",".ytd-item-section-renderer[use-small-avatars]"]);for(;(await r()).length<=0;)c.sleep(500),c.sendMessage("为获取到评论,等待500ms...");c.sendMessage("获取到评论 开始抓取评论数据..."),console.log("找到评论容器，开始处理评论");let o=t;const a=[];c.sendMessage(`准备抓取评论，总评论数: ${o}`);async function i(){let l=r();for(;l.length>0&&l.length<o;){var u=await c.waitForChildListChange(()=>{c.scrollToElementTop(l[l.length-1])},n,5e3);if(u)l=r();else break}}async function s(){const l=r();console.log(`当前找到 ${l.length} 条评论元素`);for(const u of l){if(a.length>=t)break;try{await c.waitElementInViewportUseObserver(u);let d=c.getItemTextAndLog(u,["#author-text","#header-author a"],"未找到评论用户名元素");const h=c.getItemTextAndLog(u,["#content-text"],"未找到评论内容元素");let m=c.getItemTextAndLog(u,["#author-text"],"未找到日期元素"),I="";console.log("页面没有位置元素，不查找位置元素");const v=c.getItemTextAndLog(u,["#vote-count-middle"],"未找到点赞数元素"),S=c.getItemTextAndLog(u,["#author-thumbnail-button img"],"未找到头像元素","src");a.push({userName:d,avatar:S,content:h,likes:v,date:m,location:I,isAuthor:!1})}catch(d){console.error("处理评论元素时出错:",d)}}}return console.log("开始滚动加载评论..."),await i(),await s(),console.log(`评论抓取完成，共抓取 ${a.length}/${o} 条评论`),c.sendMessage(`已抓取 ${a.length}/${o} 条评论`),a.filter(l=>l.userName&&l.content)}async function yt(){console.log("开始抓取youtube搜索页数据...");const e=(await xe()).youtube.maxSearchListCount.value,n=await Tt(e);return console.log(`共抓取到 ${n==null?void 0:n.length} 个视频数据`),{searchList:n}}async function Tt(t){const e=[];var n=c.querySelector(document,["#primary #contents","#contents"]);if(!n)return console.log("未找到搜索结果列表容器"),[];const r=()=>c.querySelectorAll(n,["#dismissible.ytd-video-renderer"]);await c.waitForResult(()=>r().length>0,1e4);const o=async()=>{for(var i=r();i.length<t;){var s=await c.waitForChildListChange(()=>{c.scrollToElementTop(i[i.length-1])},n,5e3);if(s)i=r();else break}},a=async()=>{var i=r();i.length>0&&(c.scrollToElement(i[0]),await c.sleep(1e3));for(const s of i){if(e.length>=t)break;await c.waitElementInViewportUseObserver(s,1e4);const l=c.getItemTextAndLog(s,["#video-title",".title-and-badge"],"未找到标题"),u=c.getItemTextAndLog(s,["#thumbnail>.ytd-thumbnail>img","#thumbnail img"],"未找到封面","src"),d=c.getItemTextAndLog(s,["#container>#text-container a","#container> a"],"未找到作者");let h=c.getItemTextAndLog(s,["#container>#text-container a","#container> a"],"未找到作者ID");h.includes("/@")&&(h=h.split("/@")[1]);let m=c.getItemTextAndLog(s,["#container>#text-container a","#container> a"],"未找到作者链接","href");m.startsWith("http")||(m=new URL(window.location.href).origin+m);const I=c.getItemTextAndLog(s,["#channel-thumbnail img","#img"],"未找到作者头像","src");let v=c.getItemTextAndLog(s,["#thumbnail",".ytd-thumbnail"],"未找到链接","href");v.startsWith("http")||(v=new URL(window.location.href).origin+v);let S=c.getItemTextAndLog(s,["#metadata-line>span:nth-child(3)","#metadata-line>span"],"未找到点赞数");S=c.getNumberText(S);const _=!1;let O=c.getItemTextAndLog(s,["#thumbnail badge-shape>div",'#thumbnail [class*="badge-shape__text"]'],"未找到时长");const q=c.getItemTextAndLog(s,["#metadata-line>span:nth-child(4)","#metadata-line>span:last-of-type"],"未找到发布时间");e.push({title:l,cover:u,author:d,authorID:h,authorLink:m,authorAvatar:I,link:v,likes:S,isTop:_,duration:O,publishTime:q})}};return await o(),await a(),e}async function It(){console.log("开始抓取youtube用户页面数据..."),console.log("提取用户基本信息...");const e=(await xe()).youtube.maxUserVideoCount.value,n=c.querySelector(document,["#wrapper #contentContainer #page-header","#wrapper #contentContainer "]);if(n==null)return{userId:"",username:"",avatar:"",description:"",age:"",gender:"",constellation:"",location:"",ipLocation:"",following:"",followers:"",likes:"",postCount:"",verified:"",videos:[]};let r=c.getItemTextAndLog(n,['[class*="DecoratedAvatar"] img',"img"],"未获取到用户头像","src");const o=c.getItemTextAndLog(n,[' [class*="header-headline-info"] [class*="page-header-title"]'],"未获取到用户昵称");let a="",i=c.getItemTextAndLog(n,['[class*="header-content-metadata"] [class*="metadata-row--metadata-row-inline"]'],"未获取到用户ID");const s="";let l="",u="",d=c.getItemTextAndLog(n,['[class*="truncated-text--medium-text"] span'],"未获取到用户描述"),h="",m=c.getItemTextAndLog(n,['[class*="header-content-metadata"]>div:nth-child(3)>span:first-child'],"未获取到用户粉丝数");m=c.getNumberText(m);let I="";console.log("关注数:",h),console.log("粉丝数:",m),console.log("获赞数:",I);let v=c.getItemTextAndLog(n,['[class*="header-content-metadata"]>div:nth-child(3)>span:last-child'],"未获取到用户作品数量");v=c.getNumberText(v);const S=Math.min(e,e);console.log(`将抓取最多 ${S} 个视频`);const _={userId:i,username:o,avatar:r,description:d,age:u,gender:l,constellation:"",location:s,ipLocation:"",following:h,followers:m,likes:I,postCount:v,verified:a,videos:[]},O=await St(S,_);return console.log(`成功抓取 ${O.length} 个视频`),_.videos=O,_}async function St(t=100,e){const n=[];console.log(`开始抓取用户视频，最多 ${t} 个...`);var r=c.querySelector(document,["#primary #contents"]);if(!r)return n;const o=()=>{var s=c.querySelectorAll(r,["#content","#items #dismissible"]);return s};await c.waitForResult(()=>o().length>0,1e4);const a=async()=>{for(var s=o();s.length<t;){var l=await c.waitForChildListChange(()=>{c.scrollToElementTop(s[s.length-1])},r,5e3);if(l)s=o();else break}},i=async()=>{var s=o();s.length>0&&(c.scrollToElement(s[0]),await c.sleep(1e3));for(const l of s){if(n.length>=t)break;await c.waitElementInViewportUseObserver(l);let u=c.getItemTextAndLog(l,["#video-title-link",'[class*="ViewModelHostMetadataTitle"]>a',"#video-title"],"未获取到视频标题"),d=c.getItemTextAndLog(l,["#video-title-link",'[class*="ViewModelHostMetadataTitle"]>a',"#video-title"],"未获取到视频链接","href");d.startsWith("http")||(d=new URL(window.location.href).origin+d);const h=c.getItemTextAndLog(l,["#thumbnail img",'[class*="CoreImageHost"]'],"未获取到视频封面","src"),m="",I=!1,v=c.getItemTextAndLog(l,["#overlays badge-shape"],"未获取到视频时长"),S=c.getItemTextAndLog(l,["#metadata-line span:nth-child(4)","#details>#text-metadata #metadata-container>#metadata>#metadata-line>span:nth-child(2)"],"未获取到视频发布时间");let _=c.getItemTextAndLog(l,["#details>#text-metadata #metadata-container>#metadata>#metadata-line>span:nth-child(1)","#metadata-line span:nth-child(2)",'[class*="ViewModelHostMetadataSubhead"]',"#metadata-line span"],"未获取到视频播放量");_=c.getNumberText(_),n.push({author:e.username,authorID:e.userId,authorAvatar:e.avatar,title:u,cover:h,authorLink:`${new URL(window.location.href).origin}/${e.userId}`,link:d,likes:m,isTop:I,duration:v,publishTime:S,views:_})}};return await a(),await i(),n}const _t={matches:["*://*.youtube.com/*"],main:t=>{console.log("Hello youtube content."),Fe(At)}};async function At(t,e){let n,r="unsupported";console.log("当前域名:",t),console.log("当前URL:",e),e.match(/watch\?v=[.\w]*/)?(console.log("检测到youtube视频详情页面，开始抓取视频详情数据"),n=await vt(),r="video"):e.match(/results\?search_query=/)?(console.log("检测到youtube视频搜索页面，开始抓取视频搜索数据"),n=await yt(),r="search"):e.match(/\@([.\w]*)((\/)|(\/featured)|(\/videos)|(\/shorts)|(\/streams))?$/)?(console.log("检测到youtube用户详情页面，开始抓取用户详情数据"),n=await It(),r="user"):console.log("不是支持的youtube页面类型，抓取跳过");const o=new Date().toLocaleString(),a={domain:t,type:r,data:n,fetchTime:o};return console.log("抓取结果:",a),a}function oe(t,...e){}const Lt={debug:(...t)=>oe(console.debug,...t),log:(...t)=>oe(console.log,...t),warn:(...t)=>oe(console.warn,...t),error:(...t)=>oe(console.error,...t)},ae=class ae extends Event{constructor(e,n){super(ae.EVENT_NAME,{}),this.newUrl=e,this.oldUrl=n}};g(ae,"EVENT_NAME",Te("wxt:locationchange"));let ye=ae;function Te(t){var e;return`${(e=y==null?void 0:y.runtime)==null?void 0:e.id}:youtube:${t}`}function Et(t){let e,n;return{run(){e==null&&(n=new URL(location.href),e=t.setInterval(()=>{let r=new URL(location.href);r.href!==n.href&&(window.dispatchEvent(new ye(r,n)),n=r)},1e3))}}}const X=class X{constructor(e,n){g(this,"isTopFrame",window.self===window.top);g(this,"abortController");g(this,"locationWatcher",Et(this));g(this,"receivedMessageIds",new Set);this.contentScriptName=e,this.options=n,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}get signal(){return this.abortController.signal}abort(e){return this.abortController.abort(e)}get isInvalid(){return y.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(e){return this.signal.addEventListener("abort",e),()=>this.signal.removeEventListener("abort",e)}block(){return new Promise(()=>{})}setInterval(e,n){const r=setInterval(()=>{this.isValid&&e()},n);return this.onInvalidated(()=>clearInterval(r)),r}setTimeout(e,n){const r=setTimeout(()=>{this.isValid&&e()},n);return this.onInvalidated(()=>clearTimeout(r)),r}requestAnimationFrame(e){const n=requestAnimationFrame((...r)=>{this.isValid&&e(...r)});return this.onInvalidated(()=>cancelAnimationFrame(n)),n}requestIdleCallback(e,n){const r=requestIdleCallback((...o)=>{this.signal.aborted||e(...o)},n);return this.onInvalidated(()=>cancelIdleCallback(r)),r}addEventListener(e,n,r,o){var a;n==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),(a=e.addEventListener)==null||a.call(e,n.startsWith("wxt:")?Te(n):n,r,{...o,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),Lt.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:X.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(e){var a,i,s;const n=((a=e.data)==null?void 0:a.type)===X.SCRIPT_STARTED_MESSAGE_TYPE,r=((i=e.data)==null?void 0:i.contentScriptName)===this.contentScriptName,o=!this.receivedMessageIds.has((s=e.data)==null?void 0:s.messageId);return n&&r&&o}listenForNewerScripts(e){let n=!0;const r=o=>{if(this.verifyScriptStartedEvent(o)){this.receivedMessageIds.add(o.data.messageId);const a=n;if(n=!1,a&&(e!=null&&e.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",r),this.onInvalidated(()=>removeEventListener("message",r))}};g(X,"SCRIPT_STARTED_MESSAGE_TYPE",Te("wxt:content-script-started"));let Ie=X;function Mt(){}function re(t,...e){}const Ct={debug:(...t)=>re(console.debug,...t),log:(...t)=>re(console.log,...t),warn:(...t)=>re(console.warn,...t),error:(...t)=>re(console.error,...t)};return(async()=>{try{const{main:t,...e}=_t,n=new Ie("youtube",e);return await t(n)}catch(t){throw Ct.error('The content script "youtube" crashed on startup!',t),t}})()}();
youtube;
